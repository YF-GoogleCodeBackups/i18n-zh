<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>&#22806;&#37096;&#23450;&#20041;</title><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot_8167"><link rel="home" href="index.html" title="Subversion &#26435;&#23041;&#25351;&#21335;"><link rel="up" href="svn.advanced.html" title="&#31532;&nbsp;3&nbsp;&#31456;&nbsp;&#39640;&#32423;&#20027;&#39064;"><link rel="prev" href="svn.advanced.locking.html" title="&#38145;&#23450;"><link rel="next" href="svn.advanced.pegrevs.html" title="Peg &#21644;&#23454;&#26045;&#20462;&#35746;&#29256;&#26412;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">&#22806;&#37096;&#23450;&#20041;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="svn.advanced.locking.html">&#19978;&#19968;&#39029;</a>&nbsp;</td><th width="60%" align="center">&#31532;&nbsp;3&nbsp;&#31456;&nbsp;&#39640;&#32423;&#20027;&#39064;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="svn.advanced.pegrevs.html">&#19979;&#19968;&#39029;</a></td></tr></table><hr></div><div class="section" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="svn.advanced.externals"></a>&#22806;&#37096;&#23450;&#20041;</h2></div></div></div>
      
      <p>&#26377;&#26102;&#20505;&#21019;&#24314;&#19968;&#20010;&#30001;&#22810;&#20010;&#19981;&#21516;&#26816;&#20986;&#24471;&#21040;&#30340;&#24037;&#20316;&#25335;&#36125;&#26159;&#38750;&#24120;&#26377;&#29992;&#30340;&#65292;&#20030;&#20010;&#20363;&#23376;&#65292;&#20320;&#25110;&#35768;&#24076;&#26395;&#19981;&#21516;&#30340;&#23376;&#30446;&#24405;&#26469;&#33258;&#19981;&#21516;&#30340;&#29256;&#26412;&#24211;&#20301;&#32622;&#65292;&#25110;&#32773;&#26159;&#19981;&#21516;&#30340;&#29256;&#26412;&#24211;&#12290;&#20320;&#21487;&#20197;&#25163;&#24037;&#35774;&#32622;&#36825;&#26679;&#19968;&#20010;&#24037;&#20316;&#25335;&#36125;&#8212;&#20351;&#29992;<span class="command"><strong>svn checkout</strong></span>&#26469;&#21019;&#24314;&#36825;&#31181;&#20320;&#38656;&#35201;&#30340;&#23884;&#22871;&#30340;&#24037;&#20316;&#25335;&#36125;&#32467;&#26500;&#12290;&#20294;&#26159;&#22914;&#26524;&#36825;&#20010;&#32467;&#26500;&#23545;&#25152;&#26377;&#30340;&#29992;&#25143;&#26159;&#24456;&#37325;&#35201;&#30340;&#65292;&#27599;&#20010;&#29992;&#25143;&#38656;&#35201;&#25191;&#34892;&#21516;&#26679;&#30340;&#26816;&#20986;&#25805;&#20316;&#12290;</p>
      <p>&#24456;&#24184;&#36816;&#65292;Subversion&#25552;&#20379;&#20102;<em class="firstterm">&#22806;&#37096;&#23450;&#20041;</em>&#30340;&#25903;&#25345;&#65292;&#19968;&#20010;&#22806;&#37096;&#23450;&#20041;&#26159;&#19968;&#20010;&#26412;&#22320;&#36335;&#32463;&#21040;URL&#30340;&#24433;&#23556;&#8212;&#20063;&#26377;&#21487;&#33021;&#19968;&#20010;&#29305;&#23450;&#30340;&#20462;&#35746;&#29256;&#26412;&#8212;&#19968;&#20123;&#29256;&#26412;&#21270;&#30340;&#36164;&#28304;&#12290;&#22312;Subversion&#20320;&#21487;&#20197;&#20351;&#29992;<code class="literal">svn:externals</code>&#23646;&#24615;&#26469;&#23450;&#20041;&#22806;&#37096;&#23450;&#20041;&#65292;&#20320;&#21487;&#20197;&#29992;<span class="command"><strong>svn propset</strong></span>&#25110;<span class="command"><strong>svn propedit</strong></span>(&#35265;<a class="xref" href="svn.advanced.props.html#svn.advanced.props.manip" title="&#25805;&#20316;&#23646;&#24615;">&#8220;&#25805;&#20316;&#23646;&#24615;&#8221;&#19968;&#33410;</a>)&#21019;&#24314;&#21644;&#20462;&#25913;&#36825;&#20010;&#23646;&#24615;&#12290;&#23427;&#21487;&#20197;&#35774;&#32622;&#21040;&#20219;&#20309;&#29256;&#26412;&#21270;&#30340;&#36335;&#32463;&#65292;&#23427;&#30340;&#20540;&#26159;&#19968;&#20010;&#22810;&#34892;&#30340;&#23376;&#30446;&#24405;&#65292;&#21487;&#36873;&#30340;&#20462;&#35746;&#29256;&#26412;&#26631;&#35760;&#21644;&#23436;&#20840;&#26377;&#25928;&#30340;Subversion&#29256;&#26412;&#24211;URL&#30340;&#21015;&#34920;(&#30456;&#23545;&#20110;&#35774;&#32622;&#23646;&#24615;&#30340;&#29256;&#26412;&#21270;&#30446;&#24405;)&#12290;</p>
      <p><code class="literal">svn:externals</code>&#30340;&#26041;&#20415;&#20043;&#22788;&#26159;&#36825;&#20010;&#23646;&#24615;&#35774;&#32622;&#21040;&#29256;&#26412;&#21270;&#30340;&#36335;&#24452;&#21518;&#65292;&#20219;&#20309;&#20154;&#21487;&#20197;&#20174;&#37027;&#20010;&#30446;&#24405;&#21462;&#20986;&#19968;&#20010;&#24037;&#20316;&#25335;&#36125;&#65292;&#21516;&#26679;&#24471;&#21040;&#22806;&#37096;&#23450;&#20041;&#30340;&#22909;&#22788;&#12290;&#25442;&#21477;&#35805;&#35828;&#65292;&#19968;&#26086;&#19968;&#20010;&#20154;&#21162;&#21147;&#26469;&#23450;&#20041;&#36825;&#20123;&#23884;&#22871;&#30340;&#24037;&#20316;&#25335;&#36125;&#26816;&#20986;&#65292;&#20854;&#20182;&#20219;&#20309;&#20154;&#19981;&#38656;&#35201;&#20877;&#40635;&#28902;&#20102;&#8212;Subversion&#20250;&#22312;&#21407;&#20808;&#30340;&#24037;&#20316;&#25335;&#36125;&#26816;&#20986;&#20043;&#21518;&#65292;&#20063;&#20250;&#26816;&#20986;&#22806;&#37096;&#24037;&#20316;&#25335;&#36125;&#12290;</p>
      <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">&#35686;&#21578;</h3>
        <p>&#22806;&#37096;&#23450;&#20041;&#30340;&#30456;&#23545;&#30446;&#26631;&#23376;&#30446;&#24405;&#19981;&#38656;&#35201;&#23384;&#22312;&#20110;&#20320;&#30340;&#25110;&#20854;&#23427;&#29992;&#25143;&#30340;&#31995;&#32479;&#20013;&#8212;Subversion&#20250;&#22312;&#26816;&#20986;&#24037;&#20316;&#25335;&#36125;&#26102;&#21019;&#24314;&#36825;&#20123;&#25991;&#20214;&#12290;&#23454;&#38469;&#19978;&#65292;&#20320;&#19968;&#23450;&#19981;&#35201;&#20351;&#29992;&#22806;&#37096;&#23450;&#20041;&#26469;&#20135;&#29983;&#24050;&#32463;&#22312;&#29256;&#26412;&#25511;&#21046;&#30340;&#36335;&#24452;&#12290;</p>
      </div>
      <p>You also get in the externals definition design all the
      regular benefits of Subversion properties.  The definitions are
      versioned.  If you need to change an externals definition, you
      can do so using the regular property modification subcommands.
      When you commit a change to the <code class="literal">svn:externals</code>
      property, Subversion will synchronize the checked-out items
      against the changed externals definition when you next run
      <strong class="userinput"><code>svn update</code></strong>.  The same thing will happen when
      others update their working copies and receive your changes to
      the externals definition.</p>
      <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">&#25552;&#31034;</h3>
        <p>&#22240;&#20026;<code class="literal">svn:externals</code>&#30340;&#20540;&#26159;&#22810;&#34892;&#30340;&#65292;&#25152;&#20197;&#25105;&#20204;&#24378;&#28872;&#24314;&#35758;&#20351;&#29992;<span class="command"><strong>svn propedit</strong></span>&#65292;&#32780;&#19981;&#26159;&#20351;&#29992;<span class="command"><strong>svn propset</strong></span>&#12290;</p>
      </div>
      <p>Subversion releases prior to 1.5 honor an externals
      definition format that is a multiline table of subdirectories
      (relative to the versioned directory on which the property is
      set), optional revision flags, and fully qualified, absolute
      Subversion repository URLs.  An example of this might looks as
      follows:</p>
      <pre class="screen">
$ svn propget svn:externals calc
third-party/sounds             http://svn.example.com/repos/sounds
third-party/skins -r148        http://svn.example.com/skinproj
third-party/skins/toolkit -r21 http://svn.example.com/skin-maker
</pre>
      <p>&#27880;&#24847;&#21069;&#19968;&#20010;&#22806;&#37096;&#23450;&#20041;&#23454;&#20363;&#65292;&#24403;&#26377;&#20154;&#21462;&#20986;&#20102;&#19968;&#20010;<code class="filename">calc</code>&#30446;&#24405;&#30340;&#24037;&#20316;&#25335;&#36125;&#65292;Subversion&#20250;&#32487;&#32493;&#26469;&#21462;&#20986;&#22806;&#37096;&#23450;&#20041;&#30340;&#39033;&#30446;&#12290;</p>
      <pre class="screen">
$ svn checkout http://svn.example.com/repos/calc
A  calc
A  calc/Makefile
A  calc/integer.c
A  calc/button.c
Checked out revision 148.

Fetching external item into calc/third-party/sounds
A  calc/third-party/sounds/ding.ogg
A  calc/third-party/sounds/dong.ogg
A  calc/third-party/sounds/clang.ogg
&#8230;
A  calc/third-party/sounds/bang.ogg
A  calc/third-party/sounds/twang.ogg
Checked out revision 14.

Fetching external item into calc/third-party/skins
&#8230;
</pre>
      <p>As of Subversion 1.5, though, a new format of the
      <code class="literal">svn:externals</code> property is supported.
      Externals definitions are still multiline, but the order and
      format of the various pieces of information have changed.  The
      new syntax more closely mimics the order of arguments you might
      pass to <span class="command"><strong>svn checkout</strong></span>: the optional revision
      flags come first, then the external Subversion repository URL,
      and finally the relative local subdirectory.  Notice, though,
      that this time we didn't say &#8220;<span class="quote">fully qualified, absolute
      Subversion repository URLs.</span>&#8221; That's because the new
      format supports relative URLs and URLs that carry peg revisions.
      The previous example of an externals definition might, in
      Subversion 1.5, look like the following:</p>
      <pre class="screen">
$ svn propget svn:externals calc
      http://svn.example.com/repos/sounds third-party/sounds
-r148 http://svn.example.com/skinproj third-party/skins
-r21  http://svn.example.com/skin-maker third-party/skins/toolkit
</pre>
      <p>Or, making use of the peg revision syntax (which we describe
      in detail in <a class="xref" href="svn.advanced.pegrevs.html" title="Peg &#21644;&#23454;&#26045;&#20462;&#35746;&#29256;&#26412;">&#8220;Peg &#21644;&#23454;&#26045;&#20462;&#35746;&#29256;&#26412;&#8221;&#19968;&#33410;</a>), it might
      appear as:</p>
      <pre class="screen">
$ svn propget svn:externals calc
http://svn.example.com/repos/sounds third-party/sounds
http://svn.example.com/skinproj@148 third-party/skins
http://svn.example.com/skin-maker@21 third-party/skins/toolkit
</pre>
      <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">&#25552;&#31034;</h3>
        <p>&#20320;&#19968;&#23450;&#35201;&#35201;&#24910;&#37325;&#32771;&#34385;&#22312;&#25152;&#26377;&#30340;&#22806;&#37096;&#23450;&#20041;&#20013;&#20351;&#29992;&#26126;&#30830;&#30340;&#20462;&#35746;&#29256;&#26412;&#65292;&#36825;&#26679;&#20570;&#24847;&#21619;&#30528;&#20320;&#24050;&#32463;&#20915;&#23450;&#20102;&#20309;&#26102;&#25302;&#20986;&#22806;&#37096;&#20449;&#24687;&#19981;&#21516;&#30340;&#24555;&#29031;&#65292;&#21644;&#31934;&#30830;&#30340;&#25302;&#20986;&#21738;&#20010;&#24555;&#29031;&#12290;&#38500;&#20102;&#19981;&#20250;&#21463;&#21040;&#31532;&#19977;&#26041;&#29256;&#26412;&#24211;&#30340;&#24847;&#22806;&#20462;&#25913;&#30340;&#24433;&#21709;&#20197;&#22806;&#65292;&#24403;&#20320;&#30340;&#24037;&#20316;&#25335;&#36125;&#22238;&#28335;&#21040;&#20197;&#21069;&#30340;&#29256;&#26412;&#24211;&#26102;&#65292;&#20351;&#29992;&#26126;&#30830;&#30340;&#20462;&#35746;&#29256;&#26412;&#21495;&#20250;&#35753;&#22806;&#37096;&#23450;&#20041;&#22238;&#21040;&#20197;&#21069;&#30340;&#37027;&#20010;&#20462;&#35746;&#29256;&#26412;&#65292;&#20063;&#24847;&#21619;&#30528;&#22806;&#37096;&#23450;&#20041;&#30340;&#24037;&#20316;&#25335;&#36125;&#26356;&#26032;&#20250;&#21305;&#37197;&#20197;&#21069;&#20462;&#35746;&#29256;&#26412;&#30340;&#26679;&#23376;&#12290;&#23545;&#20110;&#36719;&#20214;&#39033;&#30446;&#65292;&#36825;&#21487;&#33021;&#26159;&#32534;&#35793;&#22797;&#26434;&#20195;&#30721;&#22522;&#30340;&#32769;&#24555;&#29031;&#25104;&#21151;&#21644;&#22833;&#36133;&#30340;&#21306;&#21035;&#12290;</p>
      </div>
      <p>For most repositories, these three ways of formatting the
      externals definitions have the same ultimate effect.  They all
      bring the same benefits.  Unfortunately, they all bring the same
      annoyances, too.  Since the definitions shown use absolute URLs,
      moving or copying a directory to which they are attached will
      not affect what gets checked out as an external (though the
      relative local target subdirectory will, of course, move with the
      renamed directory).  This can be confusing&#8212;even
      frustrating&#8212;in certain situations.  For example, say you
      have a top-level directory named
      <code class="filename">my-project</code>, and you've created an externals
      definition on one of its subdirectories
      (<code class="filename">my-project/some-dir</code>) that tracks the
      latest revision of another of its subdirectories
      (<code class="filename">my-project/external-dir</code>).</p>
      <pre class="screen">
$ svn checkout http://svn.example.com/projects .
A    my-project
A    my-project/some-dir
A    my-project/external-dir
&#8230;
Fetching external item into 'my-project/some-dir/subdir'
Checked out external at revision 11.

Checked out revision 11.
$ svn propget svn:externals my-project/some-dir
subdir http://svn.example.com/projects/my-project/external-dir

$
</pre>
      <p>&#29616;&#22312;&#20320;&#20351;&#29992;<span class="command"><strong>svn move</strong></span>&#23558;&#30446;&#24405;<code class="filename">my-project</code>&#25913;&#21517;&#65292;&#27492;&#21051;&#65292;&#20320;&#30340;&#22806;&#37096;&#23450;&#20041;&#36824;&#26159;&#25351;&#21521;<code class="filename">my-project</code>&#30446;&#24405;&#65292;&#21363;&#20351;&#36825;&#20010;&#30446;&#24405;&#24050;&#32463;&#19981;&#23384;&#22312;&#20102;&#12290;</p>
      <pre class="screen">
$ svn move -q my-project renamed-project
$ svn commit -m "Rename my-project to renamed-project."
Deleting       my-project
Adding         renamed-project

Committed revision 12.
$ svn update

Fetching external item into 'renamed-project/some-dir/subdir'
svn: Target path does not exist
$
</pre>
      <p>Also, absolute URLs can cause problems with repositories
      that are available via multiple URL schemes.  For example, if
      your Subversion server is configured to allow everyone to check
      out the repository over <code class="literal">http://</code> or
      <code class="literal">https://</code>, but only allow commits to come in
      via <code class="literal">https://</code>, you have an interesting problem
      on your hands.  If your externals definitions use the
      <code class="literal">http://</code> form of the repository URLs, you
      won't be able to commit anything from the working copies created
      by those externals.  On the other hand, if they use the
      <code class="literal">https://</code> form of the URLs, anyone who might
      be checking out via <code class="literal">http://</code> because his
      client doesn't support <code class="literal">https://</code> will be
      unable to fetch the external items.  Be aware, too, that if you
      need to reparent your working copy (using <span class="command"><strong>svn switch</strong></span>
      with the <code class="option">--relocate</code> option), externals definitions will
      <span class="emphasis"><em>not</em></span> also be reparented.</p>
      <p>Subversion 1.5 takes a huge step in relieving these
     frustrations.  As mentioned earlier, the URLs used in the new
     externals definition format can be relative, and Subversion
     provides syntax magic for specifying multiple flavors of URL
     relativity.</p>
      <div class="variablelist"><dl><dt><span class="term">
            <code class="literal">../</code>
          </span></dt><dd>
            <p>Relative to the URL of the directory on which
          the <code class="literal">svn:externals</code> property is
          set</p>
          </dd><dt><span class="term">
            <code class="literal">^/</code>
          </span></dt><dd>
            <p>Relative to the root of the repository in
          which the <code class="literal">svn:externals</code> property is
          versioned</p>
          </dd><dt><span class="term">
            <code class="literal">//</code>
          </span></dt><dd>
            <p>Relative to the scheme of the URL of the
          directory on which the <code class="literal">svn:externals</code>
          property is set</p>
          </dd><dt><span class="term">
            <code class="literal">/</code>
          </span></dt><dd>
            <p>Relative to the root URL of the server on
          which the <code class="literal">svn:externals</code> property is
          versioned</p>
          </dd></dl></div>
      <p>So, looking a fourth time at our previous externals
      definition example, and making use of the new absolute URL
      syntax in various ways, we might now see:</p>
      <pre class="screen">
$ svn propget svn:externals calc
^/sounds third-party/sounds
/skinproj@148 third-party/skins
//svn.example.com/skin-maker@21 third-party/skins/toolkit
</pre>
      <p>The support that exists for externals definitions in
      Subversion remains less than ideal, though.  An externals
      definition can point only to directories, not to files.  Also, the
      local subdirectory part of the definition cannot contain
      <code class="literal">..</code> parent directory indicators (such as
      <code class="filename">../../skins/myskin</code>).  Perhaps most
      disappointingly, the working copies created via the externals
      definition support are still disconnected from the primary
      working copy (on whose versioned directories the
      <code class="literal">svn:externals</code> property was actually set).
      And Subversion still truly operates only on nondisjoint working
      copies.  So, for example, if you want to commit changes that
      you've made in one or more of those external working copies, you
      must run <span class="command"><strong>svn commit</strong></span> explicitly on those
      working copies&#8212;committing on the primary working copy will
      not recurse into any external ones.</p>
      <p>We've already mentioned some of the additional shortcomings
      of the old <code class="literal">svn:externals</code> format and how the
      new Subversion 1.5 format improves upon it.  But be careful when
      making use of the new format that you don't inadvertently cause
      problems for other folks accessing your repository who are using
      older Subversion clients.  While Subversion 1.5 clients will
      continue to recognize and support the original externals
      definition format, older clients will <span class="emphasis"><em>not</em></span>
      be able to correctly parse the new format.</p>
      <p>Besides the <span class="command"><strong>svn checkout</strong></span>, <span class="command"><strong>svn
      update</strong></span>, <span class="command"><strong>svn switch</strong></span>, and
      <span class="command"><strong>svn export</strong></span> commands which actually manage the
      <em class="firstterm">disjoint</em> (or disconnected) subdirectories
      into which externals are checked out, the <span class="command"><strong>svn
      status</strong></span> command also recognizes externals definitions.
      It displays a status code of <code class="literal">X</code> for the
      disjoint external subdirectories, and then recurses into those
      subdirectories to display the status of the external items
      themselves.  You can pass the
      <code class="option">--ignore-externals</code> option to any of these
      subcommands to disable externals definition processing.</p>
    </div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="svn.advanced.locking.html">&#19978;&#19968;&#39029;</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="svn.advanced.html">&#19978;&#19968;&#32423;</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="svn.advanced.pegrevs.html">&#19979;&#19968;&#39029;</a></td></tr><tr><td width="40%" align="left" valign="top">&#38145;&#23450;&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">&#36215;&#22987;&#39029;</a></td><td width="40%" align="right" valign="top">&nbsp;Peg &#21644;&#23454;&#26045;&#20462;&#35746;&#29256;&#26412;</td></tr></table></div></body></html>