<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>&#25903;&#25345;&#22810;&#31181;&#29256;&#26412;&#24211;&#35775;&#38382;&#26041;&#27861;</title><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot_8167"><link rel="home" href="index.html" title="Subversion &#26435;&#23041;&#25351;&#21335;"><link rel="up" href="svn.serverconfig.html" title="&#31532;&nbsp;6&nbsp;&#31456;&nbsp;&#26381;&#21153;&#37197;&#32622;"><link rel="prev" href="svn.serverconfig.pathbasedauthz.html" title="&#22522;&#20110;&#36335;&#24452;&#30340;&#25480;&#26435;"><link rel="next" href="svn.customization.html" title="&#31532;&nbsp;7&nbsp;&#31456;&nbsp;&#23450;&#21046;&#20320;&#30340; Subversion &#20307;&#39564;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">&#25903;&#25345;&#22810;&#31181;&#29256;&#26412;&#24211;&#35775;&#38382;&#26041;&#27861;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="svn.serverconfig.pathbasedauthz.html">&#19978;&#19968;&#39029;</a>&nbsp;</td><th width="60%" align="center">&#31532;&nbsp;6&nbsp;&#31456;&nbsp;&#26381;&#21153;&#37197;&#32622;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="svn.customization.html">&#19979;&#19968;&#39029;</a></td></tr></table><hr></div><div class="section" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="svn.serverconfig.multimethod"></a>&#25903;&#25345;&#22810;&#31181;&#29256;&#26412;&#24211;&#35775;&#38382;&#26041;&#27861;</h2></div></div></div>
      
      <p>&#20320;&#24050;&#32463;&#30475;&#21040;&#20102;&#19968;&#20010;&#29256;&#26412;&#24211;&#21487;&#20197;&#29992;&#22810;&#31181;&#26041;&#24335;&#35775;&#38382;&#65292;&#20294;&#26159;&#21487;&#20197;&#8212;&#25110;&#32773;&#35828;&#23433;&#20840;&#30340;&#8212;&#29992;&#20960;&#31181;&#26041;&#24335;&#21516;&#26102;&#24182;&#34892;&#30340;&#35775;&#38382;&#20320;&#30340;&#29256;&#26412;&#24211;&#21527;&#65311;&#22238;&#31572;&#26159;&#21487;&#20197;&#65292;&#20504;&#33509;&#20320;&#26377;&#19968;&#20123;&#28145;&#35851;&#36828;&#34385;&#30340;&#20351;&#29992;&#12290;</p>
      <p>&#22312;&#20219;&#20309;&#32473;&#23450;&#30340;&#26102;&#38388;&#65292;&#36825;&#20123;&#36827;&#31243;&#20250;&#35201;&#27714;&#35835;&#25110;&#32773;&#20889;&#35775;&#38382;&#20320;&#30340;&#29256;&#26412;&#24211;&#65306;</p>
      <div class="itemizedlist"><ul type="disc"><li>
          <p>&#24120;&#35268;&#30340;&#31995;&#32479;&#29992;&#25143;&#20351;&#29992;Subversion&#23458;&#25143;&#31471;(&#23458;&#25143;&#31471;&#31243;&#24207;&#26412;&#36523;)&#36890;&#36807;<code class="literal">file://</code>URL&#30452;&#25509;&#35775;&#38382;&#29256;&#26412;&#24211;</p>
        </li><li>
          <p>&#24120;&#35268;&#30340;&#31995;&#32479;&#29992;&#25143;&#36830;&#25509;&#20351;&#29992;SSH&#35843;&#29992;&#30340;&#35775;&#38382;&#29256;&#26412;&#24211;&#30340;<span class="command"><strong>svnserve</strong></span>&#36827;&#31243;(&#23601;&#20687;&#23427;&#20204;&#33258;&#24049;&#36816;&#34892;&#19968;&#26679;)&#65307;</p>
        </li><li>
          <p>&#19968;&#20010;<span class="command"><strong>svnserve</strong></span>&#36827;&#31243;&#8212;&#26159;&#19968;&#20010;&#23432;&#25252;&#36827;&#31243;&#25110;&#26159;&#36890;&#36807;<span class="command"><strong>inetd</strong></span>&#21551;&#21160;&#30340;&#8212;&#20316;&#20026;&#19968;&#20010;&#22266;&#23450;&#30340;&#29992;&#25143;&#36816;&#34892;</p>
        </li><li>
          <p>&#19968;&#20010;Apache <span class="command"><strong>httpd</strong></span>&#36827;&#31243;&#65292;&#20197;&#19968;&#20010;&#22266;&#23450;&#29992;&#25143;&#36816;&#34892;</p>
        </li></ul></div>
      <p>The most common problem administrators run into is
      repository ownership and permissions.  Does every process (or
      user) in the preceding list have the rights to read and write the
      repository's underlying data files?  Assuming you have a
      Unix-like operating system, a straightforward approach might be
      to place every potential repository user into a
      new <code class="literal">svn</code> group, and make the repository wholly
      owned by that group.  But even that's not enough, because a
      process may write to the database files using an unfriendly
      umask&#8212;one that prevents access by other users.</p>
      <p>So the next step beyond setting up a common group for
      repository users is to force every repository-accessing process
      to use a sane umask.  For users accessing the repository
      directly, you can make the <span class="command"><strong>svn</strong></span> program into a
      wrapper script that first runs <strong class="userinput"><code>umask 002</code></strong> and
      then runs the real <span class="command"><strong>svn</strong></span> client program.  You
      can write a similar wrapper script for the
      <span class="command"><strong>svnserve</strong></span> program, and add a <strong class="userinput"><code>umask
      002</code></strong> command to Apache's own startup script,
      <code class="filename">apachectl</code>.  For example:</p>
      <pre class="screen">
$ cat /usr/bin/svn

#!/bin/sh

umask 002
/usr/bin/svn-real "$@"

</pre>
      <p>&#21478;&#19968;&#20010;&#22312;&#31867;Unix&#31995;&#32479;&#19979;&#24120;&#35265;&#30340;&#38382;&#39064;&#26159;&#65292;&#24403;&#29256;&#26412;&#24211;&#22312;&#20351;&#29992;&#26102;&#65292;BerkeleyDB&#26377;&#26102;&#20505;&#21019;&#24314;&#19968;&#20010;&#26032;&#30340;&#26085;&#24535;&#25991;&#20214;&#26469;&#35760;&#24405;&#23427;&#30340;&#19996;&#35199;&#65292;&#21363;&#20351;&#36825;&#20010;&#29256;&#26412;&#24211;&#26159;&#23436;&#20840;&#30001;<span class="command"><strong>svn</strong></span>&#32452;&#25317;&#26377;&#65292;&#36825;&#20010;&#26032;&#21019;&#24314;&#30340;&#25991;&#20214;&#19981;&#26159;&#24517;&#39035;&#34987;&#21516;&#19968;&#20010;&#32452;&#25317;&#26377;&#65292;&#36825;&#32473;&#20320;&#30340;&#29992;&#25143;&#36896;&#25104;&#20102;&#26356;&#22810;&#22320;&#35768;&#21487;&#38382;&#39064;&#12290;&#19968;&#20010;&#22909;&#30340;&#24037;&#20316;&#21306;&#24212;&#35813;&#35774;&#32622;&#32452;&#30340;SUID&#23383;&#33410;&#21040;&#29256;&#26412;&#24211;&#30340;<code class="filename">db</code>&#30446;&#24405;&#65292;&#36825;&#20250;&#23548;&#33268;&#25152;&#26377;&#26032;&#21019;&#24314;&#30340;&#26085;&#24535;&#25991;&#20214;&#25317;&#26377;&#21516;&#29238;&#30446;&#24405;&#30456;&#21516;&#30340;&#32452;&#25317;&#26377;&#32773;&#12290;</p>
      <p>Once you've jumped through these hoops, your repository
      should be accessible by all the necessary processes.  It may
      seem a bit messy and complicated, but the problems of having
      multiple users sharing write access to common files are classic
      ones that are not often elegantly solved.</p>
      <p>Fortunately, most repository administrators will never
      <span class="emphasis"><em>need</em></span> to have such a complex configuration.
      Users who wish to access repositories that live on the same
      machine are not limited to using <code class="literal">file://</code>
      access URLs&#8212;they can typically contact the Apache HTTP
      server or <span class="command"><strong>svnserve</strong></span> using
      <code class="literal">localhost</code> for the server name in their
      <code class="literal">http://</code> or <code class="literal">svn://</code> URL.
      And maintaining multiple server processes for your Subversion
      repositories is likely to be more of a headache than necessary.
      We recommend that you choose a single server that best meets your
      needs and stick with it!</p>
      <div class="sidebar"><p class="title"><b>svn+ssh &#26381;&#21153;&#22120;&#26816;&#26597;&#21015;&#34920;</b></p>
        
        <p>It can be quite tricky to get a bunch of users with
        existing SSH accounts to share a repository without
        permissions problems.  If you're confused about all the things
        that you (as an administrator) need to do on a Unix-like
        system, here's a quick checklist that resummarizes some of the
        topics discussed in this section:</p>
        <div class="itemizedlist"><ul type="disc"><li>
            <p>&#25152;&#26377;&#30340;SSH&#29992;&#25143;&#38656;&#35201;&#33021;&#22815;&#35835;&#20889;&#29256;&#26412;&#24211;&#65292;&#25226;&#25152;&#26377;&#30340;SSH&#29992;&#25143;&#25918;&#21040;&#21516;&#19968;&#20010;&#32452;&#37324;&#12290;</p>
          </li><li>
            <p>&#35753;&#37027;&#20010;&#32452;&#25317;&#26377;&#25972;&#20010;&#29256;&#26412;&#24211;&#12290;</p>
          </li><li>
            <p>&#35774;&#32622;&#32452;&#30340;&#35775;&#38382;&#35768;&#21487;&#20026;&#35835;/&#20889;&#12290;</p>
          </li><li>
            <p>Your users need to use a sane umask when accessing the
            repository, so make sure <span class="command"><strong>svnserve</strong></span>
            (<code class="filename">/usr/bin/svnserve</code>, or wherever it
            lives in <code class="literal">$PATH</code>) is actually a wrapper
            script that runs <strong class="userinput"><code>umask 002</code></strong> and
            executes the real <span class="command"><strong>svnserve</strong></span>
            binary.</p>
          </li><li>
            <p><span class="command"><strong>svnlook</strong></span>&#21644;<span class="command"><strong>svnadmin</strong></span>&#30340;&#20351;&#29992;&#31867;&#20284;&#65292;&#20351;&#29992;&#20581;&#20840;&#30340;umask&#25110;&#32773;&#20351;&#29992;&#21069;&#38754;&#25552;&#21040;&#30340;&#21253;&#35065;&#31243;&#24207;&#12290;</p>
          </li></ul></div>
      </div>
    </div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="svn.serverconfig.pathbasedauthz.html">&#19978;&#19968;&#39029;</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="svn.serverconfig.html">&#19978;&#19968;&#32423;</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="svn.customization.html">&#19979;&#19968;&#39029;</a></td></tr><tr><td width="40%" align="left" valign="top">&#22522;&#20110;&#36335;&#24452;&#30340;&#25480;&#26435;&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">&#36215;&#22987;&#39029;</a></td><td width="40%" align="right" valign="top">&nbsp;&#31532;&nbsp;7&nbsp;&#31456;&nbsp;&#23450;&#21046;&#20320;&#30340; Subversion &#20307;&#39564;</td></tr></table></div></body></html>