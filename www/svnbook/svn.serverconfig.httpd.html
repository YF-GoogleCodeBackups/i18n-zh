<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>httpd - Apache &#30340; HTTP &#26381;&#21153;&#22120;</title><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot_8167"><link rel="home" href="index.html" title="Subversion &#26435;&#23041;&#25351;&#21335;"><link rel="up" href="svn.serverconfig.html" title="&#31532;&nbsp;6&nbsp;&#31456;&nbsp;&#26381;&#21153;&#37197;&#32622;"><link rel="prev" href="svn.serverconfig.svnserve.html" title="svnserve - &#23450;&#21046;&#30340;&#26381;&#21153;&#22120;"><link rel="next" href="svn.serverconfig.pathbasedauthz.html" title="&#22522;&#20110;&#36335;&#24452;&#30340;&#25480;&#26435;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">httpd - Apache &#30340; HTTP &#26381;&#21153;&#22120;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="svn.serverconfig.svnserve.html">&#19978;&#19968;&#39029;</a>&nbsp;</td><th width="60%" align="center">&#31532;&nbsp;6&nbsp;&#31456;&nbsp;&#26381;&#21153;&#37197;&#32622;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="svn.serverconfig.pathbasedauthz.html">&#19979;&#19968;&#39029;</a></td></tr></table><hr></div><div class="section" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="svn.serverconfig.httpd"></a>httpd - Apache &#30340; HTTP &#26381;&#21153;&#22120;</h2></div></div></div>
      
      <p>The Apache HTTP Server is a &#8220;<span class="quote">heavy-duty</span>&#8221;
      network server that Subversion can leverage.  Via a custom
      module, <span class="command"><strong>httpd</strong></span> makes Subversion repositories
      available to clients via the WebDAV/DeltaV protocol, which is an
      extension to HTTP 1.1 (see <code class="uri">http://www.webdav.org/</code>
      for more information).  This protocol takes the ubiquitous HTTP
      protocol that is the core of the World Wide Web, and adds
      writing&#8212;specifically, versioned
      writing&#8212;capabilities.  The result is a standardized,
      robust system that is conveniently packaged as part of the
      Apache 2.0 software, supported by numerous operating systems
      and third-party products, and doesn't require network
      administrators to open up yet another custom port.
      <sup>[<a name="d4e5859" href="#ftn.d4e5859" class="footnote">42</a>]</sup>
      While an Apache-Subversion server has more features than
      <span class="command"><strong>svnserve</strong></span>, it's also a bit more difficult
      to set up.  With flexibility often comes more complexity.</p>
      <p>&#19979;&#38754;&#30340;&#35752;&#35770;&#21253;&#25324;&#20102;&#23545;Apache&#37197;&#32622;&#25351;&#31034;&#30340;&#24341;&#29992;&#65292;&#32473;&#20102;&#19968;&#20123;&#20351;&#29992;&#36825;&#20123;&#25351;&#31034;&#30340;&#20363;&#23376;&#65292;&#35814;&#32454;&#22320;&#25551;&#36848;&#19981;&#22312;&#26412;&#31456;&#30340;&#33539;&#22260;&#20043;&#20869;&#65292;Apache&#23567;&#32452;&#32500;&#25252;&#20102;&#23436;&#32654;&#30340;&#25991;&#26723;&#65292;&#20844;&#24320;&#23384;&#25918;&#22312;&#20182;&#20204;&#30340;&#31449;&#28857;<code class="uri">http://httpd.apache.org</code>&#12290;&#20363;&#22914;&#65292;&#19968;&#20010;&#19968;&#33324;&#30340;&#37197;&#32622;&#21442;&#32771;&#20301;&#20110;<code class="uri"> http://httpd.apache.org/docs-2.0/mod/directives.html</code>&#12290;</p>
      <p>&#21516;&#26679;&#65292;&#24403;&#20320;&#20462;&#25913;&#20320;&#30340;Apache&#35774;&#32622;&#65292;&#24456;&#26377;&#21487;&#33021;&#20250;&#20986;&#29616;&#19968;&#20123;&#38169;&#35823;&#65292;&#22914;&#26524;&#20320;&#36824;&#19981;&#29087;&#24713;Apache&#30340;&#26085;&#24535;&#23376;&#31995;&#32479;&#65292;&#20320;&#19968;&#23450;&#38656;&#35201;&#35748;&#35782;&#21040;&#36825;&#19968;&#28857;&#12290;&#22312;&#20320;&#30340;&#25991;&#20214;<code class="filename">httpd.conf</code>&#37324;&#20250;&#25351;&#23450;Apache&#29983;&#25104;&#30340;&#35775;&#38382;&#21644;&#38169;&#35823;&#26085;&#24535;(<code class="literal">CustomLog</code>&#21644;<code class="literal">ErrorLog</code>&#25351;&#31034;)&#30340;&#30913;&#30424;&#20301;&#32622;&#12290;Subversion&#30340;mod_dav_svn&#20351;&#29992;Apache&#30340;&#38169;&#35823;&#26085;&#24535;&#25509;&#21475;&#65292;&#20320;&#21487;&#20197;&#27983;&#35272;&#36825;&#20010;&#25991;&#20214;&#30340;&#20869;&#23481;&#26597;&#30475;&#20449;&#24687;&#26469;&#26597;&#25214;&#38590;&#20110;&#21457;&#29616;&#30340;&#38382;&#39064;&#26681;&#28304;&#12290;</p>
      <div class="sidebar"><p class="title"><b>&#20026;&#20160;&#20040;&#26159; Apache 2&#65311;</b></p>
        
        <p>If you're a system administrator, it's very likely that
        you're already running the Apache web server and have some
        prior experience with it.  At the time of this writing, Apache 1.3
        is the more popular version of Apache.  The world has
        been somewhat slow to upgrade to the Apache 2.x series for
        various reasons: some people fear change, especially changing
        something as critical as a web server.  Other people depend on
        plug-in modules that work only against the Apache 1.3 API, and
        they are waiting for a 2.x port.  Whatever the reason, many
        people begin to worry when they first discover that
        Subversion's Apache module is written specifically for the
        Apache 2 API.</p>
        <p>&#23545;&#27492;&#38382;&#39064;&#30340;&#36866;&#24403;&#21453;&#24212;&#26159;&#65306;&#19981;&#38656;&#35201;&#25285;&#24515;&#65292;&#21516;&#26102;&#36816;&#34892;Apache 1.3&#21644;Apache 2&#38750;&#24120;&#31616;&#21333;&#65292;&#21482;&#38656;&#35201;&#23433;&#35013;&#21040;&#19981;&#21516;&#30340;&#20301;&#32622;&#65292;&#29992;Apache 2&#20316;&#20026;Subversion&#30340;&#19987;&#29992;&#26381;&#21153;&#22120;&#65292;&#24182;&#19988;&#19981;&#20351;&#29992;80&#31471;&#21475;&#65292;&#23458;&#25143;&#31471;&#21487;&#20197;&#35775;&#38382;&#29256;&#26412;&#24211;&#26102;&#22312;URL&#37324;&#25351;&#23450;&#31471;&#21475;&#65306;</p>
        <pre class="screen">
$ svn checkout http://host.example.com:7382/repos/project
</pre>
      </div>
      
      <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="svn.serverconfig.httpd.prereqs"></a>&#20808;&#20915;&#26465;&#20214;</h3></div></div></div>
        
        <p>&#20026;&#20102;&#35753;&#20320;&#30340;&#29256;&#26412;&#24211;&#20351;&#29992;HTTP&#32593;&#32476;&#65292;&#20320;&#22522;&#26412;&#19978;&#38656;&#35201;&#20004;&#20010;&#21253;&#37324;&#30340;&#22235;&#20010;&#37096;&#20998;&#12290;&#20320;&#38656;&#35201;Apache <span class="command"><strong>httpd</strong></span>2.0&#21644;&#21253;&#25324;&#30340;<span class="command"><strong>mod_dav</strong></span> DAV&#27169;&#22359;&#65292;Subversion&#21644;&#19982;&#20043;&#19968;&#21516;&#20998;&#21457;&#30340;<span class="command"><strong>mod_dav_svn</strong></span>&#25991;&#20214;&#31995;&#32479;&#25552;&#20379;&#32773;&#27169;&#22359;&#65292;&#22914;&#26524;&#20320;&#26377;&#20102;&#36825;&#20123;&#32452;&#20214;&#65292;&#32593;&#32476;&#21270;&#20320;&#30340;&#29256;&#26412;&#24211;&#23558;&#38750;&#24120;&#31616;&#21333;&#65292;&#22914;&#65306;</p>
        <div class="itemizedlist"><ul type="disc"><li>
            <p>&#37197;&#32622;&#22909;httpd 2.0&#65292;&#24182;&#19988;&#20351;&#29992;<span class="command"><strong>mod_dav</strong></span>&#21551;&#21160;</p>
          </li><li>
            <p>Installing the <span class="command"><strong>mod_dav_svn</strong></span> backend
            to <span class="command"><strong>mod_dav</strong></span>, which uses Subversion's
            libraries to access the repository</p>
          </li><li>
            <p>&#37197;&#32622;&#20320;&#30340;<code class="filename">httpd.conf</code>&#26469;&#36755;&#20986;(&#25110;&#32773;&#35828;&#26292;&#38706;)&#29256;&#26412;&#24211;</p>
          </li></ul></div>
        <p>&#20320;&#21487;&#20197;&#36890;&#36807;&#20174;&#28304;&#20195;&#30721;&#32534;&#35793;<span class="command"><strong>httpd</strong></span>&#21644;Subversion&#26469;&#23436;&#25104;&#21069;&#20004;&#20010;&#39033;&#30446;&#65292;&#20063;&#21487;&#20197;&#36890;&#36807;&#20320;&#30340;&#31995;&#32479;&#19978;&#30340;&#24050;&#32463;&#32534;&#35793;&#22909;&#30340;&#20108;&#36827;&#21046;&#21253;&#26469;&#23433;&#35013;&#12290;&#26368;&#26032;&#30340;&#20351;&#29992;Apache HTTP&#30340;Subversion&#30340;&#32534;&#35793;&#26041;&#27861;&#21644;Apache&#30340;&#37197;&#32622;&#26041;&#24335;&#21487;&#20197;&#30475;Subversion&#28304;&#20195;&#30721;&#26641;&#26681;&#30446;&#24405;&#30340;<code class="filename">INSTALL</code>&#25991;&#20214;&#12290;</p>
      </div>
      
      <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="svn.serverconfig.httpd.basic"></a>&#22522;&#26412;&#30340; Apache &#37197;&#32622;</h3></div></div></div>
        
        <p>&#19968;&#26086;&#20320;&#23433;&#35013;&#20102;&#24517;&#39035;&#30340;&#32452;&#20214;&#65292;&#21097;&#19979;&#30340;&#24037;&#20316;&#23601;&#26159;&#22312;<code class="filename">httpd.conf</code>&#37324;&#37197;&#32622;Apache&#65292;&#20351;&#29992;<code class="literal">LoadModule</code>&#26469;&#21152;&#36733;mod_dav_svn&#27169;&#22359;&#65292;&#36825;&#20010;&#25351;&#31034;&#24517;&#39035;&#20808;&#19982;&#20854;&#23427;Subversion&#30456;&#20851;&#30340;&#20854;&#23427;&#37197;&#32622;&#20986;&#29616;&#65292;&#22914;&#26524;&#20320;&#30340;Apache&#20351;&#29992;&#32570;&#30465;&#24067;&#23616;&#23433;&#35013;&#65292;&#20320;&#30340;<span class="command"><strong>mod_dav_svn</strong></span>&#27169;&#22359;&#19968;&#23450;&#22312;Apache&#23433;&#35013;&#30446;&#24405;(&#36890;&#24120;&#26159;&#22312;<code class="filename">/usr/local/apache2</code>)&#30340;<code class="filename">modules</code>&#23376;&#30446;&#24405;&#65292;<code class="literal">LoadModule</code>&#25351;&#31034;&#30340;&#35821;&#27861;&#24456;&#31616;&#21333;&#65292;&#24433;&#23556;&#19968;&#20010;&#21517;&#23383;&#21040;&#23427;&#30340;&#20849;&#20139;&#24211;&#30340;&#29289;&#29702;&#20301;&#32622;&#65306;</p>
        <pre class="screen">
LoadModule dav_svn_module     modules/mod_dav_svn.so
</pre>
        <p>&#27880;&#24847;&#65292;&#22914;&#26524;<span class="command"><strong>mod_dav</strong></span>&#26159;&#20316;&#20026;&#20849;&#20139;&#23545;&#35937;&#32534;&#35793;(&#32780;&#19981;&#26159;&#38745;&#24577;&#38142;&#25509;&#21040;<span class="command"><strong>httpd</strong></span>&#31243;&#24207;)&#65292;&#20320;&#38656;&#35201;&#20026;&#23427;&#20351;&#29992;<code class="literal">LoadModule</code>&#35821;&#21477;&#65292;&#19968;&#23450;&#30830;&#23450;&#23427;&#22312;<span class="command"><strong>mod_dav_svn</strong></span>&#20043;&#21069;&#65306;</p>
        <pre class="screen">
LoadModule dav_module         modules/mod_dav.so
LoadModule dav_svn_module     modules/mod_dav_svn.so
</pre>
        <p>&#22312;&#20320;&#30340;&#37197;&#32622;&#25991;&#20214;&#21518;&#38754;&#30340;&#20301;&#32622;&#65292;&#20320;&#38656;&#35201;&#21578;&#35785;Apache&#20320;&#22312;&#20160;&#20040;&#22320;&#26041;&#20445;&#23384;Subversion&#29256;&#26412;&#24211;(&#20063;&#35768;&#26159;&#22810;&#20010;)&#65292;<code class="literal">&#20301;&#32622;</code>&#25351;&#31034;&#26377;&#19968;&#20010;&#24456;&#20687;XML&#30340;&#31526;&#21495;&#65292;&#24320;&#22987;&#20110;&#19968;&#20010;&#24320;&#22987;&#26631;&#31614;&#65292;&#20197;&#19968;&#20010;&#32467;&#26463;&#26631;&#31614;&#32467;&#26463;&#65292;&#37197;&#21512;&#20013;&#38388;&#35768;&#22810;&#30340;&#20854;&#23427;&#37197;&#32622;&#12290;<code class="literal">Location</code>&#25351;&#31034;&#30340;&#30446;&#30340;&#26159;&#21578;&#35785;Apache&#22312;&#29305;&#23450;&#30340;URL&#20197;&#21450;&#23376;URL&#19979;&#38656;&#35201;&#29305;&#27530;&#30340;&#22788;&#29702;&#65292;&#22914;&#26524;&#26159;&#20026;Subversion&#20934;&#22791;&#30340;&#65292;&#20320;&#24076;&#26395;&#21487;&#20197;&#36890;&#36807;&#21578;&#35785;Apache&#29305;&#23450;URL&#26159;&#25351;&#21521;&#29256;&#26412;&#21270;&#30340;&#36164;&#28304;&#65292;&#20174;&#32780;&#25226;&#25903;&#25345;&#36716;&#20132;&#32473;DAV&#23618;&#65292;&#20320;&#21487;&#20197;&#21578;&#35785;Apache&#23558;&#25152;&#26377;&#36335;&#24452;&#37096;&#20998;(URL&#20013;&#26381;&#21153;&#22120;&#21517;&#31216;&#21644;&#31471;&#21475;&#20043;&#21518;&#30340;&#37096;&#20998;)&#20197;<code class="filename">/repos/</code>&#24320;&#22836;&#30340;URL&#20132;&#30001;DAV&#26381;&#21153;&#25552;&#20379;&#32773;&#22788;&#29702;&#12290;&#19968;&#20010;DAV&#26381;&#21153;&#25552;&#20379;&#32773;&#30340;&#29256;&#26412;&#24211;&#20301;&#20110;<code class="filename">/absolute/path/to/repository</code>&#65292;&#21487;&#20197;&#20351;&#29992;&#22914;&#19979;&#30340;<code class="filename">httpd.conf</code>&#35821;&#27861;&#65306;</p>
        <pre class="screen">
&lt;Location /repos&gt;
  DAV svn
  SVNPath /var/svn/repository
&lt;/Location&gt;
</pre>
        <p>&#22914;&#26524;&#20320;&#35745;&#21010;&#25903;&#25345;&#22810;&#20010;&#20855;&#22791;&#30456;&#21516;&#29238;&#30446;&#24405;&#30340;Subversion&#29256;&#26412;&#24211;&#65292;&#20320;&#26377;&#21478;&#22806;&#30340;&#36873;&#25321;&#65292;<code class="literal">SVNParentPath</code>&#25351;&#31034;&#65292;&#26469;&#34920;&#31034;&#20849;&#21516;&#30340;&#29238;&#30446;&#24405;&#12290;&#20030;&#20010;&#20363;&#23376;&#65292;&#22914;&#26524;&#20320;&#30693;&#36947;&#20250;&#22312;<code class="filename">/usr/local/svn</code>&#19979;&#21019;&#24314;&#22810;&#20010;Subversion&#29256;&#26412;&#24211;&#65292;&#24182;&#19988;&#36890;&#36807;&#31867;&#20284;<code class="uri">http://my.server.com/svn/repos1</code>&#65292;<code class="uri">http://my.server.com/svn/repos2</code>&#30340;URL&#35775;&#38382;&#65292;&#20320;&#21487;&#20197;&#29992;&#21518;&#38754;&#20363;&#23376;&#20013;&#30340;<code class="filename">httpd.conf</code>&#37197;&#32622;&#35821;&#27861;&#65306;</p>
        <pre class="screen">
&lt;Location /svn&gt;
  DAV svn

  # any "/svn/foo" URL will map to a repository /var/svn/foo
  SVNParentPath /var/svn
&lt;/Location&gt;
</pre>
        <p>Using the previous syntax, Apache will delegate the
        handling of all URLs whose path portions begin with
        <code class="filename">/svn/</code> to the Subversion DAV provider,
        which will then assume that any items in the directory
        specified by the <code class="literal">SVNParentPath</code> directive
        are actually Subversion repositories.  This is a particularly
        convenient syntax in that, unlike the use of the
        <code class="literal">SVNPath</code> directive, you don't have to
        restart Apache to create and network new repositories.</p>
        <p>&#35831;&#30830;&#23450;&#24403;&#20320;&#23450;&#20041;&#26032;&#30340;<code class="literal">Location</code>&#65292;&#19981;&#20250;&#19982;&#20854;&#23427;&#36755;&#20986;&#30340;&#20301;&#32622;&#37325;&#21472;&#12290;&#20363;&#22914;&#20320;&#30340;&#20027;&#35201;<code class="literal">DocumentRoot</code>&#26159;<code class="filename">/www</code>&#65292;&#19981;&#35201;&#25226;Subversion&#29256;&#26412;&#24211;&#36755;&#20986;&#21040;<code class="literal">&lt;Location /www/repos&gt;</code>&#65292;&#22914;&#26524;&#19968;&#20010;&#35831;&#27714;&#30340;URI&#26159;<code class="filename">/www/repos/foo.c</code>&#65292;Apache&#19981;&#30693;&#36947;&#26159;&#30452;&#25509;&#21040;<code class="filename">repos/foo.c</code>&#35775;&#38382;&#36825;&#20010;&#25991;&#20214;&#36824;&#26159;&#35753;<span class="command"><strong>mod_dav_svn</strong></span>&#20195;&#29702;&#20174;Subversion&#29256;&#26412;&#24211;&#36820;&#22238;<code class="filename">foo.c</code>&#12290;&#26381;&#21153;&#22120;&#36820;&#22238;&#30340;&#32467;&#26524;&#36890;&#24120;&#26159;<code class="literal">301 Moved Permanently</code>&#12290;</p>
        <div class="sidebar"><p class="title"><b>&#26381;&#21153;&#22120;&#21517;&#31216;&#21644;&#22797;&#21046;&#35831;&#27714;</b></p>
          
          <p>Subversion&#21033;&#29992;<code class="literal">COPY</code>&#35831;&#27714;&#31867;&#22411;&#26469;&#25191;&#34892;&#26381;&#21153;&#22120;&#31471;&#30340;&#25991;&#20214;&#21644;&#30446;&#24405;&#25335;&#36125;&#65292;&#20316;&#20026;&#19968;&#20010;&#20581;&#20840;&#30340;Apache&#27169;&#22359;&#30340;&#19968;&#37096;&#20998;&#65292;&#25335;&#36125;&#28304;&#21644;&#25335;&#36125;&#30340;&#30446;&#26631;&#36890;&#24120;&#22352;&#33853;&#22312;&#21516;&#19968;&#20010;&#26426;&#22120;&#19978;&#65292;&#20026;&#20102;&#28385;&#36275;&#36825;&#20010;&#38656;&#27714;&#65292;&#20320;&#25110;&#35768;&#38656;&#35201;&#21578;&#35785;mod_dav&#26381;&#21153;&#22120;&#20027;&#26426;&#30340;&#21517;&#31216;&#65292;&#36890;&#24120;&#20320;&#21487;&#20197;&#20351;&#29992;<code class="filename">httpd.conf</code>&#30340;<code class="literal">ServerName</code>&#25351;&#31034;&#26469;&#23436;&#25104;&#27492;&#30446;&#30340;&#12290;</p>
          <pre class="screen">
ServerName svn.example.com
</pre>
          <p>If you are using Apache's virtual hosting support via
          the <code class="literal">NameVirtualHost</code> directive, you may
          need to use the <code class="literal">ServerAlias</code> directive to
          specify additional names by which your server is known.
          Again, refer to the Apache documentation for full
          details.</p>
        </div>
        <p>&#22312;&#26412;&#38454;&#27573;&#65292;&#20320;&#19968;&#23450;&#35201;&#32771;&#34385;&#35775;&#38382;&#26435;&#38480;&#38382;&#39064;&#65292;&#22914;&#26524;&#20320;&#24050;&#32463;&#20316;&#20026;&#26222;&#36890;&#30340;web&#26381;&#21153;&#22120;&#36816;&#34892;&#36807;Apache&#65292;&#20320;&#19968;&#23450;&#26377;&#20102;&#19968;&#20123;&#20869;&#23481;&#8212;&#32593;&#39029;&#12289;&#33050;&#26412;&#21644;&#20854;&#20182;&#12290;&#36825;&#20123;&#39033;&#30446;&#24050;&#32463;&#37197;&#32622;&#20102;&#35768;&#22810;&#22312;Apache&#19979;&#21487;&#20197;&#24037;&#20316;&#30340;&#35775;&#38382;&#35768;&#21487;&#65292;&#25110;&#32773;&#26356;&#20934;&#30830;&#19968;&#28857;&#65292;&#20801;&#35768;Apache&#19982;&#36825;&#20123;&#25991;&#20214;&#19968;&#36215;&#24037;&#20316;&#12290;Apache&#24403;&#20316;&#20026;Subversion&#26381;&#21153;&#22120;&#36816;&#34892;&#26102;&#65292;&#21516;&#26679;&#38656;&#35201;&#27491;&#30830;&#30340;&#35775;&#38382;&#35768;&#21487;&#26469;&#35835;&#20889;&#20320;&#30340;Subversion&#29256;&#26412;&#24211;&#12290;</p>
        <p>&#20320;&#20250;&#38656;&#35201;&#26816;&#39564;&#26435;&#38480;&#31995;&#32479;&#30340;&#35774;&#32622;&#28385;&#36275;Subversion&#30340;&#38656;&#27714;&#65292;&#21516;&#26102;&#19981;&#20250;&#25226;&#20197;&#21069;&#30340;&#39029;&#38754;&#21644;&#33050;&#26412;&#25630;&#20081;&#12290;&#36825;&#25110;&#35768;&#24847;&#21619;&#30528;&#20462;&#25913;Subversion&#30340;&#35775;&#38382;&#35768;&#21487;&#26469;&#37197;&#21512;Apache&#26381;&#21153;&#22120;&#24050;&#32463;&#20351;&#29992;&#30340;&#24037;&#20855;&#65292;&#25110;&#32773;&#21487;&#33021;&#24847;&#21619;&#30528;&#38656;&#35201;&#20351;&#29992;<code class="filename">httpd.conf</code>&#30340;<code class="literal">User</code>&#21644;<code class="literal">Group</code>&#25351;&#31034;&#26469;&#25351;&#23450;Apache&#20316;&#20026;&#36816;&#34892;&#30340;&#29992;&#25143;&#21644;Subversion&#29256;&#26412;&#24211;&#30340;&#32452;&#12290;&#24182;&#19981;&#26159;&#21482;&#26377;&#19968;&#26465;&#27491;&#30830;&#30340;&#26041;&#24335;&#26469;&#35774;&#32622;&#35768;&#21487;&#65292;&#27599;&#20010;&#31649;&#29702;&#21592;&#37117;&#26377;&#19981;&#21516;&#30340;&#21407;&#22240;&#26469;&#20197;&#29305;&#23450;&#30340;&#26041;&#24335;&#25805;&#20316;&#65292;&#21482;&#38656;&#35201;&#24847;&#35782;&#21040;&#35768;&#21487;&#20851;&#32852;&#30340;&#38382;&#39064;&#32463;&#24120;&#22312;&#20026;Apache&#37197;&#32622;Subversion&#29256;&#26412;&#24211;&#30340;&#36807;&#31243;&#20013;&#34987;&#30095;&#24573;&#12290;</p>
      </div>
      
      <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="svn.serverconfig.httpd.authn"></a>&#35748;&#35777;&#36873;&#39033;</h3></div></div></div>
        
        <p>At this point, if you configured
        <code class="filename">httpd.conf</code> to contain something such as the
        following:</p>
        <pre class="screen">
&lt;Location /svn&gt;
  DAV svn
  SVNParentPath /var/svn
&lt;/Location&gt;
</pre>
        <p>your repository is &#8220;<span class="quote">anonymously</span>&#8221;
        accessible to the world.  Until you configure some
        authentication and authorization policies, the Subversion
        repositories that you make available via the
        <code class="literal">Location</code> directive will be generally
        accessible to everyone.  In other words:</p>
        <div class="itemizedlist"><ul type="disc"><li>
            <p>&#20219;&#20309;&#20154;&#21487;&#20197;&#20351;&#29992;Subversion&#23458;&#25143;&#31471;&#26469;&#20174;&#29256;&#26412;&#24211;URL&#21462;&#20986;&#19968;&#20010;&#24037;&#20316;&#25335;&#36125;(&#25110;&#32773;&#26159;&#23427;&#30340;&#23376;&#30446;&#24405;)&#12290;</p>
          </li><li>
            <p>&#20219;&#20309;&#20154;&#21487;&#20197;&#22312;&#27983;&#35272;&#22120;&#36755;&#20837;&#29256;&#26412;&#24211;URL&#20132;&#20114;&#27983;&#35272;&#30340;&#26041;&#24335;&#26469;&#26597;&#30475;&#29256;&#26412;&#24211;&#30340;&#26368;&#26032;&#20462;&#35746;&#29256;&#26412;&#12290;</p>
          </li><li>
            <p>&#20219;&#20309;&#20154;&#21487;&#20197;&#25552;&#20132;&#21040;&#29256;&#26412;&#24211;&#12290;</p>
          </li></ul></div>
        <p>Of course, you might have already set up
        a <code class="filename">pre-commit</code> hook script to prevent
        commits (see <a class="xref" href="svn.reposadmin.create.html#svn.reposadmin.create.hooks" title="&#23454;&#29616;&#29256;&#26412;&#24211;&#38057;&#23376;">&#8220;&#23454;&#29616;&#29256;&#26412;&#24211;&#38057;&#23376;&#8221;&#19968;&#33410;</a>).
        But as you read on, you'll see that it's also possible to use
        Apache's built-in methods to restrict access in specific
        ways.</p>
        
        <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="svn.serverconfig.httpd.authn.basic"></a>&#37197;&#32622; HTTP &#35748;&#35777;</h4></div></div></div>
          
          <p>&#26368;&#31616;&#21333;&#30340;&#23458;&#25143;&#31471;&#35748;&#35777;&#26041;&#24335;&#26159;&#36890;&#36807;HTTP&#22522;&#26412;&#35748;&#35777;&#26426;&#21046;&#65292;&#31616;&#21333;&#30340;&#20351;&#29992;&#29992;&#25143;&#21517;&#21644;&#23494;&#30721;&#26469;&#39564;&#35777;&#19968;&#20010;&#29992;&#25143;&#25152;&#33258;&#31216;&#30340;&#36523;&#20221;&#65292;Apache&#25552;&#20379;&#20102;&#19968;&#20010;<span class="command"><strong>htpasswd</strong></span>&#24037;&#20855;&#26469;&#31649;&#29702;&#21487;&#25509;&#21463;&#30340;&#29992;&#25143;&#21517;&#21644;&#23494;&#30721;&#65292;&#36825;&#20123;&#23601;&#26159;&#20320;&#24076;&#26395;&#36171;&#20104;Subversion&#29305;&#21035;&#26435;&#38480;&#30340;&#29992;&#25143;&#65292;&#35753;&#25105;&#20204;&#32473;Sally&#21644;Harry&#36171;&#20104;&#25552;&#20132;&#26435;&#38480;&#65292;&#39318;&#20808;&#65292;&#25105;&#20204;&#38656;&#35201;&#28155;&#21152;&#20182;&#20204;&#21040;&#23494;&#30721;&#25991;&#20214;&#65306;</p>
          <pre class="screen">
$ ### First time: use -c to create the file
$ ### Use -m to use MD5 encryption of the password, which is more secure
$ htpasswd -cm /etc/svn-auth-file harry
New password: *****
Re-type new password: *****
Adding password for user harry
$ htpasswd -m /etc/svn-auth-file sally
New password: *******
Re-type new password: *******
Adding password for user sally
$
</pre>
          <p>Next, you need to add some more
          <code class="filename">httpd.conf</code> directives inside your
          <code class="literal">Location</code> block to tell Apache what to do
          with your new password file.  The
          <code class="literal">AuthType</code> directive specifies the type of
          authentication system to use.  In this case, we want to
          specify the <code class="literal">Basic</code> authentication system.
          <code class="literal">AuthName</code> is an arbitrary name that you
          give for the authentication domain.  Most browsers will
          display this name in the pop-up dialog box when the browser
          is querying the user for her name and password.  Finally,
          use the <code class="literal">AuthUserFile</code> directive to specify
          the location of the password file you created using
          <span class="command"><strong>htpasswd</strong></span>.</p>
          <p>&#28155;&#21152;&#23436;&#36825;&#19977;&#20010;&#25351;&#31034;&#65292;&#20320;&#30340;<code class="literal">&lt;Location&gt;</code>&#21306;&#22359;&#19968;&#23450;&#20687;&#36825;&#20010;&#26679;&#23376;&#65306;</p>
          <pre class="screen">
&lt;Location /svn&gt;
  DAV svn
  SVNParentPath /var/svn
  AuthType Basic
  AuthName "Subversion repository"
  AuthUserFile /etc/svn-auth-file
&lt;/Location&gt;
</pre>
          <p>&#36825;&#20010;<code class="literal">&lt;Location&gt;</code>&#21306;&#22359;&#36824;&#27809;&#26377;&#32467;&#26463;&#65292;&#36824;&#19981;&#33021;&#20570;&#20219;&#20309;&#26377;&#29992;&#30340;&#20107;&#24773;&#65292;&#23427;&#21482;&#26159;&#21578;&#35785;Apache&#24403;&#38656;&#35201;&#25480;&#26435;&#26102;&#65292;&#35201;&#21435;&#21521;Subversion&#23458;&#25143;&#31471;&#32034;&#35201;&#29992;&#25143;&#21517;&#21644;&#23494;&#30721;&#12290;&#25105;&#20204;&#36825;&#37324;&#36951;&#28431;&#30340;&#65292;&#26159;&#19968;&#20123;&#21578;&#35785;Apache<span class="emphasis"><em>&#20160;&#20040;&#26679;</em></span>&#23458;&#25143;&#31471;&#38656;&#35201;&#25480;&#26435;&#30340;&#25351;&#31034;&#12290;&#21738;&#37324;&#38656;&#35201;&#25480;&#26435;&#65292;Apache&#23601;&#20250;&#22312;&#21738;&#37324;&#35201;&#27714;&#35748;&#35777;&#65292;&#26368;&#31616;&#21333;&#30340;&#26041;&#24335;&#26159;&#20445;&#25252;&#25152;&#26377;&#30340;&#35831;&#27714;&#65292;&#28155;&#21152;<code class="literal">Require valid-user</code>&#26469;&#21578;&#35785;Apache&#20219;&#20309;&#35831;&#27714;&#38656;&#35201;&#35748;&#35777;&#30340;&#29992;&#25143;&#65306;</p>
          <pre class="screen">
&lt;Location /svn&gt;
  DAV svn
  SVNParentPath /var/svn
  AuthType Basic
  AuthName "Subversion repository"
  AuthUserFile /etc/svn-auth-file
  Require valid-user
&lt;/Location&gt;
</pre>
          <p>&#19968;&#23450;&#35201;&#38405;&#35835;&#21518;&#38754;&#30340;&#37096;&#20998;(<a class="xref" href="svn.serverconfig.httpd.html#svn.serverconfig.httpd.authz" title="&#25480;&#26435;&#36873;&#39033;">&#8220;&#25480;&#26435;&#36873;&#39033;&#8221;&#19968;&#33410;</a>)&#26469;&#24471;&#21040;<code class="literal">Require</code>&#30340;&#32454;&#33410;&#65292;&#21644;&#25480;&#26435;&#25919;&#31574;&#30340;&#20854;&#20182;&#35774;&#32622;&#26041;&#27861;&#12290;</p>
          <p>One word of warning: HTTP Basic Auth passwords pass in
          very nearly plain text over the network, and thus are
          extremely insecure.</p>
          <p>Another option is to not use Basic authentication, but to
          use Digest authentication instead.  Digest authentication
          allows the server to verify the client's
          identity <span class="emphasis"><em>without</em></span> passing the plain-text
          password over the network.  Assuming that the client and
          server both know the user's password, they can verify that
          the password is the same by using it to apply a hashing
          function to a one-time bit of information.  The server sends
          a small random-ish string to the client; the client uses the
          user's password to hash the string; the server then looks to
          see whether the hashed value is what it expected.</p>
          <p>Configuring Apache for Digest authentication is also
          fairly easy, and only a small variation on our prior
          example.  Be sure to consult Apache's documentation for full
          details.</p>
          <pre class="screen">
&lt;Location /svn&gt;
  DAV svn
  SVNParentPath /var/svn
  AuthType Digest
  AuthName "Subversion repository"
  AuthDigestDomain /svn/
  AuthUserFile /etc/svn-auth-file
  Require valid-user
&lt;/Location&gt;
</pre>
          <p>If you're looking for maximum security, public key
          cryptography is the best solution.  It may be best to use
          some sort of SSL encryption, so that clients authenticate
          via <code class="literal">https://</code> instead
          of <code class="literal">http://</code>; at a bare minimum, you can
          configure Apache to use a self-signed server certificate.
          <sup>[<a name="d4e6013" href="#ftn.d4e6013" class="footnote">43</a>]</sup>
          Consult Apache's documentation (and OpenSSL documentation)
          about how to do that.</p>
        </div>
        
        <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="svn.serverconfig.httpd.authn.sslcerts"></a>SSL &#35777;&#20070;&#31649;&#29702;</h4></div></div></div>
          
          <p>&#21830;&#19994;&#24212;&#29992;&#38656;&#35201;&#36234;&#36807;&#20844;&#21496;&#38450;&#28779;&#22681;&#30340;&#29256;&#26412;&#24211;&#35775;&#38382;&#65292;&#38450;&#28779;&#22681;&#38656;&#35201;&#23567;&#24515;&#30340;&#32771;&#34385;&#38750;&#35748;&#35777;&#29992;&#25143;&#8220;<span class="quote">&#21560;&#21462;</span>&#8221;&#20182;&#20204;&#30340;&#32593;&#32476;&#27969;&#37327;&#30340;&#24773;&#20917;&#65292;SSL&#35753;&#37027;&#31181;&#24418;&#24335;&#30340;&#20851;&#27880;&#26356;&#19981;&#23481;&#26131;&#23548;&#33268;&#25935;&#24863;&#25968;&#25454;&#27844;&#38706;&#12290;</p>
          <p>If a Subversion client is compiled to use OpenSSL,
          it gains the ability to speak to an Apache server via
          <code class="literal">https://</code> URLs.  The Neon library used by
          the Subversion client is not only able to verify server
          certificates, but can also supply client certificates when
          challenged.  When the client and server have exchanged SSL
          certificates and successfully authenticated one another, all
          further communication is encrypted via a session key.</p>
          <p>It's beyond the scope of this book to describe how to
          generate client and server certificates and how to
          configure Apache to use them.  Many other books, including
          Apache's own documentation, describe this task.  But what we
          <span class="emphasis"><em>can</em></span> cover here is how to manage
          server and client certificates from an ordinary Subversion
          client.</p>
          <p>&#24403;&#36890;&#36807;<code class="literal">https://</code>&#19982;Apache&#36890;&#35759;&#26102;&#65292;&#19968;&#20010;Subversion&#23458;&#25143;&#31471;&#21487;&#20197;&#25509;&#25910;&#20004;&#31181;&#31867;&#22411;&#30340;&#20449;&#24687;&#65306;</p>
          <div class="itemizedlist"><ul type="disc"><li>
              <p>&#19968;&#20010;&#26381;&#21153;&#22120;&#35777;&#20070;</p>
            </li><li>
              <p>&#19968;&#20010;&#23458;&#25143;&#31471;&#35777;&#20070;&#30340;&#35201;&#27714;</p>
            </li></ul></div>
          <p>If the client receives a server certificate, it needs to
          verify that it trusts the certificate: is the server really
          who it claims to be?  The OpenSSL library does this by
          examining the signer of the server certificate, or
          <em class="firstterm">certificate authority</em> (CA).  If
          OpenSSL is unable to automatically trust the CA, or if some
          other problem occurs (such as an expired certificate or
          hostname mismatch), the Subversion command-line client will
          ask you whether you want to trust the server certificate
          anyway:</p>
          <pre class="screen">
$ svn list https://host.example.com/repos/project

Error validating server certificate for 'https://host.example.com:443':
 - The certificate is not issued by a trusted authority. Use the
   fingerprint to validate the certificate manually!
Certificate information:
 - Hostname: host.example.com
 - Valid: from Jan 30 19:23:56 2004 GMT until Jan 30 19:23:56 2006 GMT
 - Issuer: CA, example.com, Sometown, California, US
 - Fingerprint: 7d:e1:a9:34:33:39:ba:6a:e9:a5:c4:22:98:7b:76:5c:92:a0:9c:7b

(R)eject, accept (t)emporarily or accept (p)ermanently?
</pre>
          <p>This dialogue should look familiar; it's essentially the
          same question you've probably seen coming from your web
          browser (which is just another HTTP client like Subversion).
          If you choose the <code class="literal">(p)</code>ermanent option, the server certificate
          will be cached in your private runtime
          <code class="filename">auth/</code> area in just the same way your
          username and password are cached (see <a class="xref" href="svn.serverconfig.netmodel.html#svn.serverconfig.netmodel.credcache" title="&#23458;&#25143;&#31471;&#20973;&#35777;&#32531;&#23384;">&#8220;&#23458;&#25143;&#31471;&#20973;&#35777;&#32531;&#23384;&#8221;&#19968;&#33410;</a>).  If cached,
          Subversion will automatically trust this certificate
          in future negotiations.</p>
          <p>&#20320;&#30340;&#36816;&#34892;&#20013;<code class="filename">servers</code>&#25991;&#20214;&#20063;&#20250;&#32473;&#20320;&#33021;&#21147;&#21487;&#20197;&#35753;Subversion&#23458;&#25143;&#31471;&#33258;&#21160;&#20449;&#20219;&#29305;&#23450;&#30340;CA&#65292;&#21253;&#25324;&#20840;&#23616;&#30340;&#25110;&#26159;&#27599;&#20027;&#26426;&#20026;&#22522;&#30784;&#30340;&#65292;&#21482;&#38656;&#35201;&#35774;&#32622;<code class="literal">ssl-authority-files</code>&#20026;&#19968;&#32452;&#36887;&#21495;&#38548;&#24320;&#30340;PEM&#21152;&#23494;&#30340;CA&#35777;&#20070;&#21015;&#34920;&#65306;</p>
          <pre class="screen">
[global]
ssl-authority-files = /path/to/CAcert1.pem;/path/to/CAcert2.pem
</pre>
          <p>&#35768;&#22810;OpenSSL&#23433;&#35013;&#21253;&#25324;&#19968;&#20123;&#39044;&#20808;&#23450;&#20041;&#22909;&#30340;&#21487;&#20197;&#26222;&#36941;&#20449;&#20219;&#30340;&#8220;<span class="quote">&#32570;&#30465;&#30340;</span>&#8221;CA&#65292;&#20026;&#20102;&#35753;Subversion&#23458;&#25143;&#31471;&#33258;&#21160;&#20449;&#20219;&#36825;&#20123;&#26631;&#20934;&#26435;&#23041;&#65292;&#35774;&#32622;<code class="literal">ssl-trust-default-ca</code>&#20026;<code class="literal">true</code>&#12290;</p>
          <p>When talking to Apache, a Subversion client might also
          receive a challenge for a client certificate.  Apache is
          asking the client to identify itself: is the client really
          who it says it is?  If all goes correctly, the Subversion
          client sends back a private certificate signed by a CA that
          Apache trusts.  A client certificate is usually stored on
          disk in encrypted format, protected by a local password.
          When Subversion receives this challenge, it will ask you for
          a path to the certificate and the password that
          protects it:</p>
          <pre class="screen">
$ svn list https://host.example.com/repos/project

Authentication realm: https://host.example.com:443
Client certificate filename: /path/to/my/cert.p12
Passphrase for '/path/to/my/cert.p12':  ********
&#8230;
</pre>
          <p>&#27880;&#24847;&#36825;&#20010;&#23458;&#25143;&#31471;&#35777;&#20070;&#26159;&#19968;&#20010;&#8220;<span class="quote">p12</span>&#8221;&#25991;&#20214;&#65292;&#20026;&#20102;&#35753;Subversion&#20351;&#29992;&#23458;&#25143;&#31471;&#35777;&#20070;&#65292;&#23427;&#24517;&#39035;&#26159;&#36816;&#36755;&#26631;&#20934;&#30340;PKCS#12&#26684;&#24335;&#65292;&#22823;&#22810;&#25968;&#27983;&#35272;&#22120;&#21487;&#20197;&#23548;&#20837;&#21644;&#23548;&#20986;&#36825;&#31181;&#26684;&#24335;&#30340;&#35777;&#20070;&#65292;&#21478;&#19968;&#20010;&#36873;&#25321;&#26159;&#29992;OpenSSL&#21629;&#20196;&#34892;&#24037;&#20855;&#26469;&#36716;&#21270;&#23384;&#22312;&#30340;&#35777;&#20070;&#20026;PKCS#12&#26684;&#24335;&#12290;</p>
          <p>&#20877;&#27425;&#65292;&#36816;&#34892;&#20013;<code class="filename">servers</code>&#25991;&#20214;&#20801;&#35768;&#20320;&#20026;&#27599;&#20010;&#20027;&#26426;&#33258;&#21160;&#21709;&#24212;&#36825;&#31181;&#35201;&#27714;&#65292;&#21333;&#20010;&#25110;&#20004;&#26465;&#20449;&#24687;&#21487;&#20197;&#29992;&#36816;&#34892;&#21442;&#25968;&#26469;&#25551;&#36848;&#65306;</p>
          <pre class="screen">
[groups]
examplehost = host.example.com

[examplehost]
ssl-client-cert-file = /path/to/my/cert.p12
ssl-client-cert-password = somepassword
</pre>
          <p>&#19968;&#26086;&#20320;&#35774;&#32622;&#20102;<code class="literal">ssl-client-cert-file</code>&#21644; <code class="literal">ssl-client-cert-password</code>&#21442;&#25968;&#65292;Subversion&#23458;&#25143;&#31471;&#21487;&#20197;&#33258;&#21160;&#21709;&#24212;&#23458;&#25143;&#31471;&#35777;&#20070;&#35831;&#27714;&#32780;&#19981;&#20250;&#25171;&#25200;&#20320;&#12290;<sup>[<a name="d4e6058" href="#ftn.d4e6058" class="footnote">44</a>]</sup></p>
        </div>
      </div>
      
      <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="svn.serverconfig.httpd.authz"></a>&#25480;&#26435;&#36873;&#39033;</h3></div></div></div>
        
        <p>&#27492;&#21051;&#65292;&#20320;&#24050;&#32463;&#37197;&#32622;&#20102;&#35748;&#35777;&#65292;&#20294;&#26159;&#27809;&#26377;&#37197;&#32622;&#25480;&#26435;&#65292;Apache&#21487;&#20197;&#35201;&#27714;&#29992;&#25143;&#35748;&#35777;&#24182;&#19988;&#30830;&#23450;&#36523;&#20221;&#65292;&#20294;&#26159;&#24182;&#27809;&#26377;&#35828;&#26126;&#36825;&#20010;&#36523;&#20221;&#30340;&#24590;&#26679;&#20801;&#35768;&#21644;&#38480;&#21046;&#65292;&#36825;&#20010;&#37096;&#20998;&#25551;&#36848;&#20102;&#20004;&#31181;&#25511;&#21046;&#35775;&#38382;&#29256;&#26412;&#24211;&#30340;&#31574;&#30053;&#12290;</p>
        
        <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="svn.serverconfig.httpd.authz.blanket"></a>&#25972;&#20307;&#35775;&#38382;&#25511;&#21046;</h4></div></div></div>
          
          <p>&#26368;&#31616;&#21333;&#30340;&#35775;&#38382;&#25511;&#21046;&#24418;&#24335;&#26159;&#25480;&#26435;&#29305;&#23450;&#29992;&#25143;&#20026;&#21482;&#35835;&#29256;&#26412;&#24211;&#35775;&#38382;&#25110;&#32773;&#26159;&#35835;/&#20889;&#35775;&#38382;&#29256;&#26412;&#24211;&#12290;</p>
          <p>&#20320;&#21487;&#20197;&#36890;&#36807;&#22312;<code class="literal">&lt;Location&gt;</code>&#21306;&#22359;&#28155;&#21152;<code class="literal">Require valid-user</code>&#25351;&#31034;&#26469;&#38480;&#21046;&#25152;&#26377;&#30340;&#29256;&#26412;&#24211;&#25805;&#20316;&#65292;&#20351;&#29992;&#25105;&#20204;&#21069;&#38754;&#30340;&#20363;&#23376;&#65292;&#36825;&#24847;&#21619;&#30528;&#21482;&#26377;&#23458;&#25143;&#31471;&#21482;&#21487;&#20197;&#26159;<code class="literal">harry</code>&#25110;&#32773;<code class="literal">sally</code>&#65292;&#32780;&#19988;&#20182;&#20204;&#24517;&#39035;&#25552;&#20379;&#27491;&#30830;&#30340;&#29992;&#25143;&#21517;&#21450;&#23545;&#24212;&#23494;&#30721;&#65292;&#36825;&#26679;&#20801;&#35768;&#23545;Subversion&#29256;&#26412;&#24211;&#20570;&#20219;&#20309;&#20107;&#65306;</p>
          <pre class="screen">
&lt;Location /svn&gt;
  DAV svn
  SVNParentPath /var/svn

  # how to authenticate a user
  AuthType Basic
  AuthName "Subversion repository"
  AuthUserFile /path/to/users/file

  # only authenticated users may access the repository
  Require valid-user
&lt;/Location&gt;
</pre>
          <p>&#26377;&#26102;&#20505;&#65292;&#20320;&#19981;&#38656;&#35201;&#36825;&#26679;&#20005;&#23494;&#65292;&#20030;&#20010;&#20363;&#23376;&#65292;Subversion&#33258;&#24049;&#22312;<a class="ulink" href="http://svn.collab.net/repos/svn" target="_top">http://svn.collab.net/repos/svn</a>&#30340;&#28304;&#20195;&#30721;&#20801;&#35768;&#20840;&#19990;&#30028;&#30340;&#20154;&#25191;&#34892;&#29256;&#26412;&#24211;&#30340;&#21482;&#35835;&#25805;&#20316;(&#20363;&#22914;&#26816;&#20986;&#25105;&#20204;&#30340;&#24037;&#20316;&#25335;&#36125;&#21644;&#20351;&#29992;&#27983;&#35272;&#22120;&#27983;&#35272;&#29256;&#26412;&#24211;)&#65292;&#20294;&#26159;&#38480;&#23450;&#21482;&#26377;&#35748;&#35777;&#29992;&#25143;&#21487;&#20197;&#25191;&#34892;&#20889;&#25805;&#20316;&#12290;&#20026;&#20102;&#25191;&#34892;&#29305;&#23450;&#30340;&#38480;&#21046;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;<code class="literal">Limit</code>&#21644;<code class="literal">LimitExcept</code>&#37197;&#32622;&#25351;&#31034;&#65292;&#23601;&#20687;<code class="literal">Location</code>&#25351;&#31034;&#65292;&#36825;&#20010;&#21306;&#22359;&#26377;&#24320;&#22987;&#21644;&#32467;&#26463;&#26631;&#31614;&#65292;&#20320;&#38656;&#35201;&#22312;<code class="literal">&lt;Location&gt;</code>&#20013;&#28155;&#21152;&#36825;&#20010;&#25351;&#31034;&#12290;</p>
          <p>&#22312;<code class="literal">Limit</code>&#21644;<code class="literal">LimitExcept</code>&#20013;&#20351;&#29992;&#30340;&#21442;&#25968;&#26159;&#21487;&#20197;&#34987;&#36825;&#20010;&#21306;&#22359;&#24433;&#21709;&#30340;HTTP&#35831;&#27714;&#31867;&#22411;&#65292;&#20030;&#20010;&#20363;&#23376;&#65292;&#22914;&#26524;&#20320;&#24076;&#26395;&#31105;&#27490;&#25152;&#26377;&#30340;&#29256;&#26412;&#24211;&#35775;&#38382;&#65292;&#21482;&#26159;&#20445;&#30041;&#24403;&#21069;&#25903;&#25345;&#30340;&#21482;&#35835;&#25805;&#20316;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;<code class="literal">LimitExcept</code>&#25351;&#31034;&#65292;&#24182;&#19988;&#20351;&#29992;<code class="literal">GET</code>&#65292;<code class="literal">PROPFIND</code>&#65292;<code class="literal">OPTIONS</code>&#21644;<code class="literal">REPORT</code>&#35831;&#27714;&#31867;&#22411;&#21442;&#25968;&#65292;&#28982;&#21518;&#21069;&#38754;&#25552;&#21040;&#36807;&#30340;<code class="literal">Require valid-user</code>&#25351;&#31034;&#23558;&#20250;&#22312;<code class="literal">&lt;LimitExcept&gt;</code>&#21306;&#22359;&#20013;&#32780;&#19981;&#26159;&#22312;<code class="literal">&lt;Location&gt;</code>&#21306;&#22359;&#12290;</p>
          <pre class="screen">
&lt;Location /svn&gt;
  DAV svn
  SVNParentPath /var/svn

  # how to authenticate a user
  AuthType Basic
  AuthName "Subversion repository"
  AuthUserFile /path/to/users/file

  # For any operations other than these, require an authenticated user.
  &lt;LimitExcept GET PROPFIND OPTIONS REPORT&gt;
    Require valid-user
  &lt;/LimitExcept&gt;
&lt;/Location&gt;
</pre>
          <p>&#36825;&#37324;&#21482;&#26159;&#19968;&#20123;&#31616;&#21333;&#30340;&#20363;&#23376;&#65292;&#24819;&#30475;&#20851;&#20110;Apache&#35775;&#38382;&#25511;&#21046;<code class="literal">Require</code>&#25351;&#31034;&#30340;&#26356;&#28145;&#20837;&#20449;&#24687;&#65292;&#21487;&#20197;&#26597;&#30475;Apache&#25991;&#26723;&#20013;&#30340;&#25945;&#31243;&#38598;<code class="uri">http://httpd.apache.org/docs-2.0/misc/tutorials.html</code>&#20013;&#30340;<code class="literal">Security</code>&#37096;&#20998;&#12290;</p>
        </div>
        
        <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="svn.serverconfig.httpd.authz.perdir"></a>&#27599;&#30446;&#24405;&#35775;&#38382;&#25511;&#21046;</h4></div></div></div>
          
          <p>&#20063;&#21487;&#20197;&#20351;&#29992;Apache&#30340;httpd&#27169;&#22359;<span class="command"><strong>mod_authz_svn</strong></span>&#26356;&#21152;&#32454;&#33268;&#30340;&#35774;&#32622;&#35775;&#38382;&#26435;&#38480;&#65292;&#36825;&#20010;&#27169;&#22359;&#25910;&#38598;&#23458;&#25143;&#31471;&#20256;&#36882;&#36807;&#26469;&#30340;&#19981;&#21516;&#30340;&#26214;&#28073;&#30340;URL&#20449;&#24687;&#65292;&#35810;&#38382;<span class="command"><strong>mod_dav_svn</strong></span>&#26469;&#35299;&#30721;&#65292;&#28982;&#21518;&#26681;&#25454;&#22312;&#37197;&#32622;&#25991;&#20214;&#23450;&#20041;&#30340;&#35775;&#38382;&#25919;&#31574;&#26469;&#35009;&#20915;&#35831;&#27714;&#12290;</p>
          <p>&#22914;&#26524;&#20320;&#20174;&#28304;&#20195;&#30721;&#21019;&#24314;Subversion&#65292;<span class="command"><strong>mod_authz_svn</strong></span>&#20250;&#33258;&#21160;&#38468;&#21152;&#21040;<span class="command"><strong>mod_dav_svn</strong></span>&#65292;&#35768;&#22810;&#20108;&#36827;&#21046;&#20998;&#21457;&#29256;&#26412;&#20063;&#20250;&#33258;&#21160;&#23433;&#35013;&#65292;&#20026;&#20102;&#39564;&#35777;&#23427;&#26159;&#23433;&#35013;&#27491;&#30830;&#65292;&#30830;&#23450;&#23427;&#26159;&#22312;<code class="filename">httpd.conf</code>&#30340;<code class="literal">LoadModule</code>&#25351;&#31034;&#20013;&#30340;<span class="command"><strong>mod_dav_svn</strong></span>&#21518;&#38754;&#65306;</p>
          <pre class="screen">
LoadModule dav_module         modules/mod_dav.so
LoadModule dav_svn_module     modules/mod_dav_svn.so
LoadModule authz_svn_module   modules/mod_authz_svn.so
</pre>
          <p>&#20026;&#20102;&#28608;&#27963;&#36825;&#20010;&#27169;&#22359;&#65292;&#20320;&#38656;&#35201;&#37197;&#32622;&#20320;&#30340;<code class="literal">Location</code>&#21306;&#22359;&#30340;<code class="literal">AuthzSVNAccessFile</code>&#25351;&#31034;&#65292;&#25351;&#23450;&#20445;&#23384;&#36335;&#24452;&#20013;&#30340;&#29256;&#26412;&#24211;&#35775;&#38382;&#25919;&#31574;&#30340;&#25991;&#20214;&#12290;(&#19968;&#20250;&#20799;&#25105;&#20204;&#23558;&#20250;&#35752;&#35770;&#36825;&#20010;&#25991;&#20214;&#30340;&#26684;&#24335;&#12290;)</p>
          <p>Apache&#38750;&#24120;&#30340;&#28789;&#27963;&#65292;&#20320;&#21487;&#20197;&#20174;&#19977;&#31181;&#27169;&#24335;&#37324;&#36873;&#25321;&#19968;&#31181;&#26469;&#37197;&#32622;&#20320;&#30340;&#21306;&#22359;&#65292;&#20316;&#20026;&#24320;&#22987;&#65292;&#20320;&#36873;&#25321;&#19968;&#31181;&#22522;&#26412;&#30340;&#37197;&#32622;&#27169;&#24335;&#12290;(&#19979;&#38754;&#30340;&#20363;&#23376;&#38750;&#24120;&#31616;&#21333;&#65307;&#35265;Apache&#33258;&#24049;&#30340;&#25991;&#26723;&#20013;&#30340;&#35748;&#35777;&#21644;&#25480;&#26435;&#36873;&#39033;&#26469;&#26597;&#30475;&#26356;&#22810;&#30340;&#32454;&#33410;&#12290;)</p>
          <p>&#26368;&#31616;&#21333;&#30340;&#21306;&#22359;&#26159;&#20801;&#35768;&#20219;&#20309;&#20154;&#21487;&#20197;&#35775;&#38382;&#65292;&#22312;&#36825;&#20010;&#22330;&#26223;&#37324;&#65292;Apache&#20915;&#19981;&#20250;&#21457;&#36865;&#35748;&#35777;&#35831;&#27714;&#65292;&#25152;&#26377;&#30340;&#29992;&#25143;&#20316;&#20026;&#8220;<span class="quote">&#21311;&#21517;</span>&#8221;&#23545;&#24453;(&#35265;<a class="xref" href="svn.serverconfig.httpd.html#svn.serverconfig.httpd.authz.perdir.ex-1" title="&#20363;&nbsp;6.1.&nbsp;&#21311;&#21517;&#35775;&#38382;&#30340;&#37197;&#32622;&#26679;&#20363;">&#20363;&nbsp;6.1 &#8220;&#21311;&#21517;&#35775;&#38382;&#30340;&#37197;&#32622;&#26679;&#20363;&#8221;</a>&#12290;)</p>
          <div class="example"><a name="svn.serverconfig.httpd.authz.perdir.ex-1"></a><p class="title"><b>&#20363;&nbsp;6.1.&nbsp;&#21311;&#21517;&#35775;&#38382;&#30340;&#37197;&#32622;&#26679;&#20363;</b></p><div class="example-contents">
            
            <pre class="programlisting">
&lt;Location /repos&gt;
  DAV svn
  SVNParentPath /var/svn

  # our access control policy
  AuthzSVNAccessFile /path/to/access/file
&lt;/Location&gt;
          </pre>
          </div></div><br class="example-break">
          <p>&#22312;&#21478;&#19968;&#20010;&#26497;&#31471;&#65292;&#20320;&#21487;&#20197;&#37197;&#32622;&#20026;&#25298;&#32477;&#25152;&#26377;&#20154;&#30340;&#35748;&#35777;&#65292;&#25152;&#26377;&#23458;&#25143;&#31471;&#24517;&#39035;&#25552;&#20379;&#35777;&#26126;&#33258;&#24049;&#36523;&#20221;&#30340;&#35777;&#20070;&#65292;&#20320;&#36890;&#36807;<code class="literal">Require valid-user</code>&#25351;&#31034;&#26469;&#38459;&#27490;&#26080;&#26465;&#20214;&#30340;&#35748;&#35777;&#65292;&#24182;&#19988;&#23450;&#20041;&#19968;&#31181;&#35748;&#35777;&#30340;&#25163;&#27573;&#12290;(&#35265;<a class="xref" href="svn.serverconfig.httpd.html#svn.serverconfig.httpd.authz.perdir.ex-2" title="&#20363;&nbsp;6.2.&nbsp;&#35748;&#35777;&#35775;&#38382;&#30340;&#37197;&#32622;&#26679;&#20363;">&#20363;&nbsp;6.2 &#8220;&#35748;&#35777;&#35775;&#38382;&#30340;&#37197;&#32622;&#26679;&#20363;&#8221;</a>&#12290;)</p>
          <div class="example"><a name="svn.serverconfig.httpd.authz.perdir.ex-2"></a><p class="title"><b>&#20363;&nbsp;6.2.&nbsp;&#35748;&#35777;&#35775;&#38382;&#30340;&#37197;&#32622;&#26679;&#20363;</b></p><div class="example-contents">
            
            <pre class="programlisting">
&lt;Location /repos&gt;
  DAV svn
  SVNParentPath /var/svn

  # our access control policy
  AuthzSVNAccessFile /path/to/access/file

  # only authenticated users may access the repository
  Require valid-user

  # how to authenticate a user
  AuthType Basic
  AuthName "Subversion repository"
  AuthUserFile /path/to/users/file
&lt;/Location&gt;
          </pre>
          </div></div><br class="example-break">
          <p>&#31532;&#19977;&#31181;&#27969;&#34892;&#30340;&#27169;&#24335;&#26159;&#20801;&#35768;&#35748;&#35777;&#21644;&#21311;&#21517;&#29992;&#25143;&#30340;&#32452;&#21512;&#65292;&#20030;&#20010;&#20363;&#23376;&#65292;&#35768;&#22810;&#31649;&#29702;&#21592;&#24076;&#26395;&#20801;&#35768;&#21311;&#21517;&#29992;&#25143;&#35835;&#21462;&#29305;&#23450;&#30340;&#29256;&#26412;&#24211;&#36335;&#24452;&#65292;&#20294;&#24076;&#26395;&#21482;&#26377;&#35748;&#35777;&#29992;&#25143;&#21487;&#20197;&#35835;(&#25110;&#32773;&#20889;)&#26356;&#22810;&#25935;&#24863;&#30340;&#21306;&#22495;&#65292;&#22312;&#36825;&#20010;&#35774;&#32622;&#37324;&#65292;&#25152;&#26377;&#30340;&#29992;&#25143;&#24320;&#22987;&#26102;&#29992;&#21311;&#21517;&#29992;&#25143;&#35775;&#38382;&#29256;&#26412;&#24211;&#65292;&#22914;&#26524;&#20320;&#30340;&#35775;&#38382;&#25511;&#21046;&#31574;&#30053;&#22312;&#20219;&#20309;&#26102;&#20505;&#35201;&#27714;&#19968;&#20010;&#30495;&#23454;&#30340;&#29992;&#25143;&#21517;&#65292;Apache&#23558;&#20250;&#35201;&#27714;&#35748;&#35777;&#23458;&#25143;&#31471;&#65292;&#20026;&#27492;&#65292;&#20320;&#21487;&#20197;&#21516;&#26102;&#20351;&#29992;<code class="literal">Satisfy Any</code>&#21644;<code class="literal">Require valid-user</code>&#25351;&#31034;&#12290;(&#35265;<a class="xref" href="svn.serverconfig.httpd.html#svn.serverconfig.httpd.authz.perdir.ex-3" title="&#20363;&nbsp;6.3.&nbsp;&#28151;&#21512;&#35748;&#35777;/&#21311;&#21517;&#35775;&#38382;&#30340;&#37197;&#32622;&#26679;&#20363;">&#20363;&nbsp;6.3 &#8220;&#28151;&#21512;&#35748;&#35777;/&#21311;&#21517;&#35775;&#38382;&#30340;&#37197;&#32622;&#26679;&#20363;&#8221;</a>&#12290;)</p>
          <div class="example"><a name="svn.serverconfig.httpd.authz.perdir.ex-3"></a><p class="title"><b>&#20363;&nbsp;6.3.&nbsp;&#28151;&#21512;&#35748;&#35777;/&#21311;&#21517;&#35775;&#38382;&#30340;&#37197;&#32622;&#26679;&#20363;</b></p><div class="example-contents">
            
            <pre class="programlisting">
&lt;Location /repos&gt;
  DAV svn
  SVNParentPath /var/svn

  # our access control policy
  AuthzSVNAccessFile /path/to/access/file

  # try anonymous access first, resort to real
  # authentication if necessary.
  Satisfy Any
  Require valid-user

  # how to authenticate a user
  AuthType Basic
  AuthName "Subversion repository"
  AuthUserFile /path/to/users/file
&lt;/Location&gt;
          </pre>
          </div></div><br class="example-break">
          <p>Once you've settled on one of these three
          basic <code class="filename">httpd.conf</code> templates, you need to
          create your file containing access rules for particular
          paths within the repository.  We describe this later in
          this chapter, in
          <a class="xref" href="svn.serverconfig.pathbasedauthz.html" title="&#22522;&#20110;&#36335;&#24452;&#30340;&#25480;&#26435;">&#8220;&#22522;&#20110;&#36335;&#24452;&#30340;&#25480;&#26435;&#8221;&#19968;&#33410;</a>.</p>
        </div>
        
        <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="svn.serverconfig.httpd.authz.pathauthzoff"></a>&#31105;&#29992;&#22522;&#20110;&#36335;&#24452;&#30340;&#26816;&#26597;</h4></div></div></div>
          
          <p>The <span class="command"><strong>mod_dav_svn</strong></span> module goes through a
          lot of work to make sure that data you've marked
          &#8220;<span class="quote">unreadable</span>&#8221; doesn't get accidentally leaked.
          This means it needs to closely monitor all of the paths
          and file-contents returned by commands such as <span class="command"><strong>svn
          checkout</strong></span> and <span class="command"><strong>svn update</strong></span>.
          If these commands encounter a path that isn't
          readable according to some authorization policy, the
          path is typically omitted altogether.  In the case of
          history or rename tracing&#8212;for example, running a command such
          as <strong class="userinput"><code>svn cat -r OLD foo.c</code></strong> on a file that
          was renamed long ago&#8212;the rename tracking will simply
          halt if one of the object's former names is determined to be
          read-restricted.</p>
          <p>All of this path checking can sometimes be quite
          expensive, especially in the case of <span class="command"><strong>svn
          log</strong></span>.  When retrieving a list of revisions, the
          server looks at every changed path in each revision and
          checks it for readability.  If an unreadable path is
          discovered, it's omitted from the list of the
          revision's changed paths (normally seen with
          the <code class="option">--verbose</code> option), and the whole log
          message is suppressed.  Needless to say, this can be
          time-consuming on revisions that affect a large number of
          files.  This is the cost of security: even if you haven't
          configured a module such as
          <span class="command"><strong>mod_authz_svn</strong></span> at all, the
          <span class="command"><strong>mod_dav_svn</strong></span> module is still asking Apache
          <span class="command"><strong>httpd</strong></span> to run authorization checks on
          every path.  The <span class="command"><strong>mod_dav_svn</strong></span> module has
          no idea what authorization modules have been installed, so
          all it can do is ask Apache to invoke whatever might be
          present.</p>
          <p>On the other hand, there's also an escape hatch of
          sorts, which allows you to trade security features for
          speed.  If you're not enforcing any sort of per-directory
          authorization (i.e., not using
          <span class="command"><strong>mod_authz_svn</strong></span> or similar module),
          you can disable all of this path checking.  In your
          <code class="filename">httpd.conf</code> file, use the
          <code class="literal">SVNPathAuthz</code> directive as shown in
          <a class="xref" href="svn.serverconfig.httpd.html#svn.serverconfig.httpd.authz.pathauthzoff.ex-1" title="&#20363;&nbsp;6.4.&nbsp;&#31105;&#29992;&#25152;&#26377;&#30340;&#36335;&#24452;&#26816;&#26597;">&#20363;&nbsp;6.4 &#8220;&#31105;&#29992;&#25152;&#26377;&#30340;&#36335;&#24452;&#26816;&#26597;&#8221;</a>.
        </p>
          <div class="example"><a name="svn.serverconfig.httpd.authz.pathauthzoff.ex-1"></a><p class="title"><b>&#20363;&nbsp;6.4.&nbsp;&#31105;&#29992;&#25152;&#26377;&#30340;&#36335;&#24452;&#26816;&#26597;</b></p><div class="example-contents">
            
            <pre class="programlisting">
&lt;Location /repos&gt;
  DAV svn
  SVNParentPath /var/svn

  SVNPathAuthz off
&lt;/Location&gt;
          </pre>
          </div></div><br class="example-break">
          <p>The <code class="literal">SVNPathAuthz</code> directive
          is &#8220;<span class="quote">on</span>&#8221; by default.  When
          set to &#8220;<span class="quote">off,</span>&#8221; all path-based authorization
          checking is disabled;
          <span class="command"><strong>mod_dav_svn</strong></span> stops invoking authorization
          checks on every path it discovers.</p>
        </div>
      </div>
      
      <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="svn.serverconfig.httpd.extra"></a>&#39069;&#22806;&#30340;&#31958;&#26524;</h3></div></div></div>
        
        <p>&#25105;&#20204;&#24050;&#32463;&#35206;&#30422;&#20102;&#20851;&#20110;&#35748;&#35777;&#21644;&#25480;&#26435;&#30340;Apache&#21644; <span class="command"><strong>mod_dav_svn</strong></span>&#30340;&#22823;&#22810;&#25968;&#36873;&#39033;&#65292;&#20294;&#26159;Apache&#36824;&#25552;&#20379;&#20102;&#35768;&#22810;&#24456;&#22909;&#30340;&#29305;&#24615;&#12290;</p>
        
        <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="svn.serverconfig.httpd.extra.browsing"></a>&#29256;&#26412;&#24211;&#27983;&#35272;</h4></div></div></div>
          
          <p>&#20351;&#29992;Apache/WebDAV&#37197;&#32622;Subversion&#29256;&#26412;&#24211;&#26102;&#19968;&#20010;&#38750;&#24120;&#26377;&#29992;&#30340;&#22909;&#22788;&#26159;&#21487;&#20197;&#29992;&#26222;&#36890;&#30340;&#27983;&#35272;&#22120;&#23519;&#30475;&#26368;&#26032;&#30340;&#29256;&#26412;&#24211;&#25991;&#20214;&#65292;&#22240;&#20026;Subversion&#20351;&#29992;URL&#26469;&#37492;&#21035;&#29256;&#26412;&#24211;&#29256;&#26412;&#21270;&#30340;&#36164;&#28304;&#65292;&#29256;&#26412;&#24211;&#20351;&#29992;&#30340;HTTP&#20026;&#22522;&#30784;&#30340;URL&#20063;&#21487;&#20197;&#30452;&#25509;&#36755;&#20837;&#21040;Web&#27983;&#35272;&#22120;&#20013;&#65292;&#20320;&#30340;&#27983;&#35272;&#22120;&#20250;&#21457;&#36865;&#19968;&#20010;<code class="literal">GET</code>&#35831;&#27714;&#21040;URL&#65292;&#26681;&#25454;&#35775;&#38382;&#30340;URL&#26159;&#25351;&#21521;&#19968;&#20010;&#29256;&#26412;&#21270;&#30340;&#30446;&#24405;&#36824;&#26159;&#25991;&#20214;&#65292;mod_dav_svn&#20250;&#36127;&#36131;&#21015;&#20986;&#30446;&#24405;&#21015;&#34920;&#25110;&#32773;&#26159;&#25991;&#20214;&#20869;&#23481;&#12290;</p>
          <p>&#22240;&#20026;URL&#19981;&#33021;&#30830;&#23450;&#20320;&#25152;&#24076;&#26395;&#30475;&#21040;&#30340;&#36164;&#28304;&#30340;&#29256;&#26412;&#65292;<span class="command"><strong>mod_dav_svn</strong></span>&#20250;&#19968;&#30452;&#36820;&#22238;&#26368;&#26032;&#30340;&#29256;&#26412;&#65292;&#36825;&#26679;&#20250;&#26377;&#19968;&#20123;&#32654;&#22937;&#30340;&#21103;&#20316;&#29992;&#65292;&#20320;&#21487;&#20197;&#30452;&#25509;&#25226;Subversion&#30340;URL&#20256;&#36882;&#32473;&#25991;&#26723;&#20316;&#20026;&#24341;&#29992;&#65292;&#36825;&#20123;URL&#20250;&#19968;&#30452;&#25351;&#21521;&#25991;&#26723;&#26368;&#26032;&#30340;&#26448;&#26009;&#65292;&#24403;&#28982;&#65292;&#20320;&#20063;&#21487;&#20197;&#22312;&#21035;&#30340;&#32593;&#31449;&#20316;&#20026;&#36229;&#38142;&#20351;&#29992;&#36825;&#20123;URL&#12290;</p>
          <div class="sidebar"><p class="title"><b>&#25105;&#21487;&#20197;&#30475;&#21040;&#32769;&#30340;&#20462;&#35746;&#29256;&#26412;&#21527;&#65311;</b></p>
            
            <p>&#36890;&#36807;&#19968;&#20010;&#26222;&#36890;&#30340;&#27983;&#35272;&#22120;&#65311;&#19968;&#21477;&#35805;&#65306;&#19981;&#21487;&#20197;&#65292;&#33267;&#23569;&#26159;&#24403;&#20320;&#21482;&#20351;&#29992;<span class="command"><strong>mod_dav_svn</strong></span>&#20316;&#20026;&#21807;&#19968;&#30340;&#24037;&#20855;&#26102;&#12290;</p>
            <p>&#20320;&#30340;Web&#27983;&#35272;&#22120;&#21482;&#20250;&#35828;&#26222;&#36890;&#30340;HTTP&#65292;&#20063;&#23601;&#26159;&#35828;&#23427;&#21482;&#20250;GET&#20844;&#20849;&#30340;URL&#65292;&#36825;&#20010;URL&#20195;&#34920;&#20102;&#26368;&#26032;&#29256;&#26412;&#30340;&#25991;&#20214;&#21644;&#30446;&#24405;&#65292;&#26681;&#25454;WebDAV/DeltaV&#35268;&#33539;&#65292;&#27599;&#31181;&#26381;&#21153;&#22120;&#23450;&#20041;&#20102;&#19968;&#31181;&#31169;&#26377;&#30340;URL&#35821;&#27861;&#26469;&#20195;&#34920;&#32769;&#30340;&#36164;&#28304;&#30340;&#29256;&#26412;&#65292;&#36825;&#20010;&#35821;&#27861;&#23545;&#23458;&#25143;&#31471;&#26159;&#19981;&#36879;&#26126;&#30340;&#65292;&#20026;&#20102;&#24471;&#21040;&#32769;&#30340;&#29256;&#26412;&#65292;&#19968;&#20010;&#23458;&#25143;&#31471;&#24517;&#39035;&#36890;&#36807;&#19968;&#31181;&#35268;&#33539;&#36807;&#31243;&#26469;&#8220;<span class="quote">&#21457;&#29616;</span>&#8221;&#27491;&#30830;&#30340;URL&#65307;&#36825;&#20010;&#36807;&#31243;&#21253;&#25324;&#25191;&#34892;&#19968;&#31995;&#21015;WebDAV PROPFIND&#35831;&#27714;&#21644;&#29702;&#35299;DeltaV&#27010;&#24565;&#65292;&#36825;&#20123;&#20107;&#24773;&#19968;&#33324;&#26159;&#20320;&#30340;web&#27983;&#35272;&#22120;&#20570;&#19981;&#20102;&#30340;&#12290;</p>
            <p>So, to answer the question, one obvious way to see
            older revisions of files and directories is by passing the
            <code class="option">--revision</code> (<code class="option">-r</code>) argument
            to the <span class="command"><strong>svn list</strong></span> and <span class="command"><strong>svn
            cat</strong></span> commands.  To browse old revisions with your
            web browser, however, you can use third-party software.  A
            good example of this is ViewVC (<code class="uri">http://viewvc.tigris.org/</code>).  ViewVC was originally
            written to display CVS repositories through the Web,
            <sup>[<a name="d4e6204" href="#ftn.d4e6204" class="footnote">45</a>]</sup>
            and the latest releases are able to understand Subversion
            repositories as well.</p>
          </div>
          <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h5 class="title"><a name="svn.serverconfig.httpd.extra.browsing.mimetype"></a>&#27491;&#30830;&#30340; MIME &#31867;&#22411;</h5></div></div></div>
            
            <p>&#24403;&#27983;&#35272;Subversion&#29256;&#26412;&#24211;&#26102;&#65292;web&#27983;&#35272;&#22120;&#36890;&#36807;&#20174;Apache&#30340;HTTP GET&#36820;&#22238;&#20869;&#23481;&#20013;&#26597;&#30475;<code class="literal">Content-Type:</code>&#22836;&#21487;&#20197;&#30693;&#36947;&#22914;&#20309;&#28210;&#26579;&#25991;&#20214;&#30340;&#32447;&#32034;&#65292;&#36825;&#20010;&#20540;&#26159;&#19968;&#31181;MIME&#31867;&#22411;&#12290;&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;Apache&#21578;&#35785;&#27983;&#35272;&#22120;&#25152;&#26377;&#30340;&#29256;&#26412;&#24211;&#25991;&#20214;&#37117;&#26159;&#32570;&#30465;&#30340;MIME&#31867;&#22411;&#65292;&#36890;&#24120;&#26159;<code class="literal">text/plain</code>&#65292;&#36825;&#26679;&#26377;&#26102;&#20505;&#20250;&#35753;&#20154;&#27822;&#20007;&#65292;&#22914;&#26524;&#19968;&#20010;&#29992;&#25143;&#24076;&#26395;&#29256;&#26412;&#24211;&#25991;&#20214;&#33021;&#22815;&#26356;&#26377;&#24847;&#20041;&#30340;&#28210;&#26579;&#8212;&#20363;&#22914;&#19968;&#20010;<code class="filename">foo.html</code>&#65292;&#22312;&#27983;&#35272;&#26102;&#26368;&#22909;&#33021;&#22815;&#25353;&#29031;HTML&#26041;&#24335;&#28210;&#26579;&#12290;</p>
            <p>To make this happen, you need only to make sure that
            your files have the
            proper <code class="literal">svn:mime-type</code> set.  We discuss this 
            in more detail in
            <a class="xref" href="svn.advanced.props.file-portability.html#svn.advanced.props.special.mime-type" title="&#25991;&#20214;&#20869;&#23481;&#31867;&#22411;">&#8220;&#25991;&#20214;&#20869;&#23481;&#31867;&#22411;&#8221;&#19968;&#33410;</a>,
            and you can even configure your client to automatically
            attach proper <code class="literal">svn:mime-type</code> properties
            to files entering the repository for the first time; see
            <a class="xref" href="svn.advanced.props.html#svn.advanced.props.auto" title="&#33258;&#21160;&#35774;&#32622;&#23646;&#24615;">&#8220;&#33258;&#21160;&#35774;&#32622;&#23646;&#24615;&#8221;&#19968;&#33410;</a>.</p>
            <p>So in our example, if one were to set
          the <code class="literal">svn:mime-type</code> property
          to <code class="literal">text/html</code> on
          file <code class="filename">foo.html</code>, Apache would
          properly tell your web browser to render the file as HTML.
          One could also attach proper <code class="literal">image/*</code>
          MIME-type properties to image files and ultimately get an
          entire web site to be viewable directly from a repository!
          There's generally no problem with this, as long as the web
          site doesn't contain any dynamically generated
          content.</p>
          </div>
          <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h5 class="title"><a name="svn.serverconfig.httpd.extra.browsing.xslt"></a>&#23450;&#21046;&#22806;&#35266;</h5></div></div></div>
            
            <p>&#20320;&#36890;&#24120;&#20250;&#22312;&#29256;&#26412;&#21270;&#30340;&#25991;&#20214;&#30340;URL&#20043;&#22806;&#24471;&#21040;&#26356;&#22810;&#22320;&#29992;&#22788;&#8212;&#27605;&#31455;&#37027;&#37324;&#26159;&#26377;&#36259;&#30340;&#20869;&#23481;&#23384;&#22312;&#30340;&#22320;&#26041;&#65292;&#20294;&#26159;&#20320;&#20250;&#20598;&#23572;&#27983;&#35272;&#19968;&#20010;Subversion&#30340;&#30446;&#24405;&#21015;&#34920;&#65292;&#20320;&#20250;&#24456;&#24555;&#21457;&#29616;&#23637;&#31034;&#21015;&#34920;&#29983;&#25104;&#30340;HTML&#38750;&#24120;&#22522;&#26412;&#65292;&#24182;&#19988;&#19968;&#23450;&#27809;&#26377;&#22312;&#22806;&#35266;&#19978;(&#25110;&#32773;&#26159;&#26377;&#36259;&#19978;)&#19979;&#21151;&#22827;&#65292;&#20026;&#20102;&#33258;&#23450;&#20041;&#36825;&#20123;&#30446;&#24405;&#26174;&#31034;&#65292;Subversion&#25552;&#20379;&#20102;&#19968;&#20010;XML&#30446;&#24405;&#29305;&#24615;&#65292;&#19968;&#20010;&#21333;&#29420;&#30340;<code class="literal">SVNIndexXSLT</code>&#25351;&#31034;&#22312;&#20320;&#30340;<code class="filename">httpd.conf</code>&#25991;&#20214;&#29256;&#26412;&#24211;&#30340;<code class="literal">Location</code>&#22359;&#37324;&#65292;&#23427;&#23558;&#20250;&#25351;&#23548;mod_dav_svn&#22312;&#26174;&#31034;&#30446;&#24405;&#21015;&#34920;&#30340;&#26102;&#20505;&#29983;&#25104;XML&#36755;&#20986;&#65292;&#24182;&#19988;&#24341;&#29992;&#20320;&#36873;&#25321;&#30340;XSLT&#26679;&#24335;&#34920;&#25991;&#20214;&#65306;</p>
            <pre class="screen">
&lt;Location /svn&gt;
  DAV svn
  SVNParentPath /var/svn
  SVNIndexXSLT "/svnindex.xsl"
  &#8230;
&lt;/Location&gt;
</pre>
            <p>Using the <code class="literal">SVNIndexXSLT</code> directive and
           a creative XSLT stylesheet, you can make your directory
           listings match the color schemes and imagery used in other
           parts of your web site.  Or, if you'd prefer, you can use
           the sample stylesheets provided in the Subversion source
           distribution's <code class="filename">tools/xslt/</code> directory.
           Keep in mind that the path provided to the
           <code class="literal">SVNIndexXSLT</code> directory is actually a URL
           path&#8212;browsers need to be able to read your
           stylesheets to make use of them!</p>
          </div>
          <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h5 class="title"><a name="svn.serverconfig.httpd.extra.browsing.reposlisting"></a>&#21015;&#20986;&#29256;&#26412;&#24211;</h5></div></div></div>
            
            <p>&#22914;&#26524;&#20320;&#36890;&#36807; <code class="literal">SVNParentPath</code>&#25351;&#31034;&#20174;&#19968;&#20010;URL&#32500;&#25252;&#19968;&#32452;&#29256;&#26412;&#24211;&#65292;&#20063;&#21487;&#20197;&#35753;Apache&#22312;&#27983;&#35272;&#22120;&#26174;&#31034;&#25152;&#26377;&#23384;&#22312;&#30340;&#29256;&#26412;&#24211;&#65292;&#21482;&#38656;&#35201;&#36890;&#36807;<code class="literal">SVNListParentPath</code>&#25351;&#31034;&#28608;&#27963;&#65306;</p>
            <pre class="screen">
&lt;Location /svn&gt;
  DAV svn
  SVNParentPath /var/svn
  SVNListParentPath on
  &#8230;
&lt;/Location&gt;
</pre>
            <p>&#22914;&#26524;&#19968;&#20010;&#29992;&#25143;&#23558;&#27983;&#35272;&#22120;&#25351;&#21521;<code class="literal">http://host.example.com/svn/</code>&#65292;&#22905;&#19968;&#23450;&#20250;&#30475;&#21040;<code class="filename">/var/svn</code>&#19979;&#25152;&#26377;&#30340;Subversion&#29256;&#26412;&#24211;&#65292;&#24456;&#26126;&#26174;&#36825;&#26159;&#19968;&#20214;&#23433;&#20840;&#38382;&#39064;&#65292;&#25152;&#20197;&#36825;&#20010;&#29305;&#24615;&#40664;&#35748;&#26159;&#20851;&#38381;&#30340;&#12290;</p>
          </div>
        </div>
        
        <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="svn.serverconfig.httpd.extra.logging"></a>Apache &#26085;&#24535;</h4></div></div></div>
          
          <p>Because Apache is an HTTP server at heart, it contains
          fantastically flexible logging features.  It's beyond the
          scope of this book to discuss all of the ways logging can be
          configured, but we should point out that even the most
          generic <code class="filename">httpd.conf</code> file will cause
          Apache to produce two logs:
          <code class="filename">error_log</code>
          and <code class="filename">access_log</code>.  These logs may appear
          in different places, but are typically created in the
          logging area of your Apache installation.  (On Unix, they
          often live
          in <code class="filename">/usr/local/apache2/logs/</code>.)</p>
          <p><code class="filename">error_log</code>&#25551;&#36848;&#20102;&#25152;&#26377;Apache&#36816;&#34892;&#20013;&#30340;&#20869;&#37096;&#38169;&#35823;&#65292;<code class="filename">access_log</code>&#35760;&#24405;&#20102;Apache&#25509;&#25910;&#21040;&#30340;&#25152;&#26377;HTTP&#35831;&#27714;&#65292;&#36825;&#20010;&#26085;&#24535;&#24456;&#23481;&#26131;&#26597;&#30475;&#65292;&#20363;&#22914;&#21253;&#25324;Subversion&#23458;&#25143;&#31471;&#30340;IP&#22320;&#22336;&#65292;&#21738;&#20123;&#29992;&#25143;&#27491;&#30830;&#35748;&#35777;&#21644;&#35831;&#27714;&#25104;&#21151;&#36824;&#26159;&#22833;&#36133;&#12290;</p>
          <p>&#19981;&#24184;&#30340;&#26159;&#65292;&#22240;&#20026;HTTP&#26159;&#26080;&#29366;&#24577;&#21327;&#35758;&#65292;&#21363;&#20351;&#26368;&#31616;&#21333;&#30340;Subversion&#23458;&#25143;&#31471;&#25805;&#20316;&#20250;&#20135;&#29983;&#22810;&#20010;&#32593;&#32476;&#35831;&#27714;&#65292;&#24456;&#38590;&#36890;&#36807;&#26597;&#30475;<code class="filename">access_log</code>&#26469;&#30830;&#23450;&#29992;&#25143;&#30340;&#25805;&#20316;&#8212;&#22823;&#22810;&#25968;&#25805;&#20316;&#30475;&#36215;&#26469;&#20687;&#26159;&#19968;&#31995;&#21015;&#31070;&#31192;&#30340;<code class="literal">PROPPATCH</code>&#12289;<code class="literal">GET</code>&#12289;<code class="literal">PUT</code>&#21644;<code class="literal">REPORT</code>&#35831;&#27714;&#12290;&#26356;&#31967;&#31957;&#30340;&#26159;&#65292;&#35768;&#22810;&#23458;&#25143;&#27573;&#25805;&#20316;&#20250;&#21457;&#36865;&#20960;&#20046;&#23436;&#20840;&#30456;&#21516;&#30340;&#19968;&#31995;&#21015;&#35831;&#27714;&#65292;&#25152;&#20197;&#26356;&#21152;&#38590;&#20197;&#21306;&#20998;&#12290;</p>
          <p><code class="literal">mod_dav_svn</code>&#20250;&#25104;&#20026;&#19968;&#20010;&#36741;&#21161;&#65292;&#36890;&#36807;&#28608;&#27963;&#8220;<span class="quote">operational logging</span>&#8221;&#23646;&#24615;&#65292;&#20320;&#21487;&#20197;&#21578;&#35785;<code class="literal">mod_dav_svn</code>&#21019;&#24314;&#21478;&#22806;&#30340;&#26085;&#24535;&#25991;&#20214;&#65292;&#26469;&#25551;&#36848;&#20320;&#30340;&#23458;&#25143;&#31471;&#37117;&#20570;&#20102;&#21738;&#20123;&#39640;&#32423;&#25805;&#20316;&#12290;</p>
          <p>To do this, you need to make use of
          Apache's <code class="literal">CustomLog</code> directive (which is
          explained in more detail in Apache's own documentation).
          Be sure to invoke this
          directive <span class="emphasis"><em>outside</em></span> your
          Subversion <code class="literal">Location</code> block:</p>
          <pre class="screen">
&lt;Location /svn&gt;
  DAV svn
  &#8230;
&lt;/Location&gt;

CustomLog logs/svn_logfile "%t %u %{SVN-ACTION}e" env=SVN-ACTION
</pre>
          <p>In this example, we're asking Apache to create a special
          logfile, <code class="filename">svn_logfile</code>, in the standard
          Apache <code class="filename">logs</code> directory.
          The <code class="literal">%t</code> and <code class="literal">%u</code>
          variables are replaced by the time and username of the
          request, respectively.  The really important parts are the
          two instances of <code class="literal">SVN-ACTION</code>.
          When Apache sees that variable, it substitutes the value of
          the <code class="literal">SVN-ACTION</code> environment variable,
          which is automatically set by <span class="command"><strong>mod_dav_svn</strong></span>
          whenever it detects a high-level client action.</p>
          <p>So, instead of having to interpret a
          traditional <code class="filename">access_log</code> like
          this:</p>
          <pre class="screen">
[26/Jan/2007:22:25:29 -0600] "PROPFIND /svn/calc/!svn/vcc/default HTTP/1.1" 207 398
[26/Jan/2007:22:25:29 -0600] "PROPFIND /svn/calc/!svn/bln/59 HTTP/1.1" 207 449
[26/Jan/2007:22:25:29 -0600] "PROPFIND /svn/calc HTTP/1.1" 207 647
[26/Jan/2007:22:25:29 -0600] "REPORT /svn/calc/!svn/vcc/default HTTP/1.1" 200 607
[26/Jan/2007:22:25:31 -0600] "OPTIONS /svn/calc HTTP/1.1" 200 188
[26/Jan/2007:22:25:31 -0600] "MKACTIVITY /svn/calc/!svn/act/e6035ef7-5df0-4ac0-b811-4be7c823f998 HTTP/1.1" 201 227
&#8230;
</pre>
          <p>you can peruse a much more
          intelligible <code class="filename">svn_logfile</code> like
          this:</p>
          <pre class="screen">
[26/Jan/2007:22:24:20 -0600] - get-dir /tags r1729 props
[26/Jan/2007:22:24:27 -0600] - update /trunk r1729 depth=infinity send-copyfrom-args
[26/Jan/2007:22:25:29 -0600] - status /trunk/foo r1729 depth=infinity
[26/Jan/2007:22:25:31 -0600] sally commit r1730
</pre>
          <p>&#23436;&#20840;&#35760;&#24405;&#30340;&#26085;&#24535;&#21160;&#20316;&#35265;<a class="xref" href="svn.ref.mod_dav_svn.conf.html#svn.ref.mod_dav_svn.conf.logging" title="&#39640;&#32423;&#26085;&#24535;">&#8220;&#39640;&#32423;&#26085;&#24535;&#8221;&#19968;&#33410;</a>&#12290;</p>
        </div>
        
        <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="svn.serverconfig.httpd.extra.writethruproxy"></a>&#36890;&#36807;&#20195;&#29702;&#20889;</h4></div></div></div>
          
          <p>One of the nice advantages of using Apache as a
          Subversion server is that it can be set up for simple
          replication.  For example, suppose that your team is
          distributed across four offices around the globe.  The
          Subversion repository can exist only in one of those
          offices, which means the other three offices will not enjoy
          accessing it&#8212;they're likely to experience
          significantly slower traffic and response times when
          updating and committing code.  A powerful solution is to set
          up a system consisting of one <em class="firstterm">master</em>
          Apache server and several <em class="firstterm">slave</em>
          Apache servers.  If you place a slave server in each office,
          users can check out a working copy from whichever slave
          is closest to them.  All read requests go to their local
          slave.  Write requests get automatically routed to the
          single master server.  When the commit completes, the master
          then automatically &#8220;<span class="quote">pushes</span>&#8221; the new revision to
          each slave server using the <span class="command"><strong>svnsync</strong></span>
          replication tool.</p>
          <p>This configuration creates a huge perceptual speed
          increase for your users, because Subversion client traffic
          is typically 80&#8211;90% read requests.  And if those
          requests are coming from a <span class="emphasis"><em>local</em></span>
          server, it's a huge win.</p>
          <p>In this section, we'll walk you through a standard setup
          of this single-master/multiple-slave system.  However, keep
          in mind that your servers must be running at least Apache
          2.2.0 (with <span class="command"><strong>mod_proxy</strong></span> loaded) and
          Subversion 1.5 (<span class="command"><strong>mod_dav_svn</strong></span>).</p>
          <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h5 class="title"><a name="svn.serverconfig.httpd.extra.writethruproxy.configure"></a>&#37197;&#32622;&#26381;&#21153;&#22120;</h5></div></div></div>
            
            <p>First, configure your master server's
            <code class="filename">httpd.conf</code> file in the usual way.
            Make the repository available at a certain URI location,
            and configure authentication and authorization however
            you'd like.  After that's done, configure each of your
            &#8220;<span class="quote">slave</span>&#8221; servers in the exact same way, but
            add the special <code class="literal">SVNMasterURI</code> directive
            to the block:</p>
            <pre class="screen">
&lt;Location /svn&gt;
  DAV svn
  SVNPath /var/svn/repos
  SVNMasterURI http://master.example.com/svn
  &#8230;
&lt;/Location&gt;
</pre>
            <p>This new directive tells a slave server to redirect
            all write requests to the master.  (This is done
            automatically via Apache's <span class="command"><strong>mod_proxy</strong></span>
            module.)  Ordinary read requests, however, are still
            serviced by the slaves.  Be sure that your master and
            slave servers all have matching authentication and
            authorization configurations;  if they fall out of sync,
            it can lead to big headaches.</p>
            <p>Next, we need to deal with the problem of infinite
            recursion.  With the current configuration, imagine what
            will happen when a Subversion client performs a commit to
            the master server.  After the commit completes, the server
            uses <span class="command"><strong>svnsync</strong></span> to replicate the new
            revision to each slave.  But because
            <span class="command"><strong>svnsync</strong></span> appears to be just another
            Subversion client performing a commit, the slave will
            immediately attempt to proxy the incoming write request
            back to the master!  Hilarity ensues.</p>
            <p>The solution to this problem is to have the master
            push revisions to a different
            <code class="literal">&lt;Location&gt;</code> on the slaves.  This
            location is configured to <span class="emphasis"><em>not</em></span> proxy
            write requests at all, but to accept normal commits from
            (and only from) the master's IP address:</p>
            <pre class="screen">
&lt;Location /svn-proxy-sync&gt;
  DAV svn
  SVNPath /var/svn/repos
  Order deny,allow
  Deny from all
  # Only let the server's IP address access this Location:
  Allow from 10.20.30.40
  &#8230;
&lt;/Location&gt;
</pre>
          </div>
          <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h5 class="title"><a name="svn.serverconfig.httpd.extra.writethruproxy.replicate"></a>&#35774;&#32622;&#22797;&#21046;</h5></div></div></div>
            
            <p>Now that you've configured
            your <code class="literal">Location</code> blocks on master and
            slaves, you need to configure the master to replicate to
            the slaves.  This is done the usual way&#8212;
            using <span class="command"><strong>svnsync</strong></span>.  If you're not familiar
            with this tool, see
            <a class="xref" href="svn.reposadmin.maint.html#svn.reposadmin.maint.replication" title="&#29256;&#26412;&#24211;&#22797;&#21046;">&#8220;&#29256;&#26412;&#24211;&#22797;&#21046;&#8221;&#19968;&#33410;</a> for
            details.</p>
            <p>First, make sure that each slave repository has a
            <code class="filename">pre-revprop-change</code> hook script which
            allows remote revision property changes.  (This is
            standard procedure for being on the receiving end of
            <span class="command"><strong>svnsync</strong></span>.) Then log into the master
            server and configure each of the slave repository URIs to
            receive data from the master repository on the local
            disk:</p>
            <pre class="screen">
$ svnsync init http://slave1.example.com/svn-proxy-sync file://var/svn/repos
Copied properties for revision 0.
$ svnsync init http://slave2.example.com/svn-proxy-sync file://var/svn/repos
Copied properties for revision 0.
$ svnsync init http://slave3.example.com/svn-proxy-sync file://var/svn/repos
Copied properties for revision 0.

# Perform the initial replication

$ svnsync sync http://slave1.example.com/svn-proxy-sync
Transmitting file data ....
Committed revision 1.
Copied properties for revision 1.
Transmitting file data .......
Committed revision 2.
Copied properties for revision 2.
&#8230;

$ svnsync sync http://slave2.example.com/svn-proxy-sync
Transmitting file data ....
Committed revision 1.
Copied properties for revision 1.
Transmitting file data .......
Committed revision 2.
Copied properties for revision 2.
&#8230;

$ svnsync sync http://slave3.example.com/svn-proxy-sync
Transmitting file data ....
Committed revision 1.
Copied properties for revision 1.
Transmitting file data .......
Committed revision 2.
Copied properties for revision 2.
&#8230;
</pre>
            <p>After this is done, we configure the master server's
            <code class="literal">post-commit</code> hook script to invoke
            <span class="command"><strong>svnsync</strong></span> on each slave server:</p>
            <pre class="programlisting">
#!/bin/sh
# Post-commit script to replicate newly committed revision to slaves

svnsync sync http://slave1.example.com/svn-proxy-sync &gt; /dev/null 2&gt;&amp;1
svnsync sync http://slave2.example.com/svn-proxy-sync &gt; /dev/null 2&gt;&amp;1
svnsync sync http://slave3.example.com/svn-proxy-sync &gt; /dev/null 2&gt;&amp;1
</pre>
            <p>The extra bits on the end of each line aren't
            necessary, but they're a sneaky way to allow the sync
            commands to run in the background so that the Subversion
            client isn't left waiting forever for the commit to
            finish.  In addition to this
            <code class="literal">post-commit</code> hook, you'll need a
            <code class="literal">post-revprop-change</code> hook as well so
            that when a user, say, modifies a log message, the slave
            servers get that change also:</p>
            <pre class="programlisting">
#!/bin/sh
# Post-revprop-change script to replicate revprop-changes to slaves

REV=${2}
svnsync copy-revprops http://slave1.example.com/svn-proxy-sync ${REV} &gt; /dev/null 2&gt;&amp;1
svnsync copy-revprops http://slave2.example.com/svn-proxy-sync ${REV} &gt; /dev/null 2&gt;&amp;1
svnsync copy-revprops http://slave3.example.com/svn-proxy-sync ${REV} &gt; /dev/null 2&gt;&amp;1
</pre>
            <p>The only thing we've left out here is what to do about
            locks.  Because locks are strictly enforced by the master
            server (the only place where commits happen), we don't
            technically need to do anything.  Many teams don't use
            Subversion's locking features at all, so it may be a
            nonissue for you.  However, if lock changes aren't
            replicated from master to slaves, it means that clients
            won't be able to query the status of locks
            (e.g., <strong class="userinput"><code>svn status -u</code></strong> will show no
            information about repository locks).  If this bothers you,
            you can write <code class="literal">post-lock</code> and
            <code class="literal">post-unlock</code> hook scripts that run
            <span class="command"><strong>svn lock</strong></span> and <span class="command"><strong>svn
            unlock</strong></span> on each slave machine, presumably through
            a remote shell method such as SSH.  That's left as an
            exercise for the reader!</p>
          </div>
          <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h5 class="title"><a name="svn.serverconfig.httpd.extra.writethruproxy.caveats"></a>&#21578;&#35819;</h5></div></div></div>
            
            <p>Your master/slave replication system should now be
            ready to use.  A couple of words of warning are in order,
            however.  Remember that this replication isn't entirely
            robust in the face of computer or network crashes.  For
            example, if one of the automated
            <span class="command"><strong>svnsync</strong></span> commands fails to complete for
            some reason, the slaves will begin to fall behind.  For
            example, your remote users will see that they've committed
            revision 100, but then when they run <span class="command"><strong>svn
            update</strong></span>, their local server will tell them that
            revision 100 doesn't yet exist!  Of course, the problem
            will be automatically fixed the next time another commit
            happens and the subsequent <span class="command"><strong>svnsync</strong></span> is
            successful&#8212;the sync will replicate all waiting
            revisions.  But still, you may want to set up some sort of
            out-of-band monitoring to notice synchronization failures
            and force <span class="command"><strong>svnsync</strong></span> to run when things go
            wrong.</p>
            <div class="sidebar"><p class="title"><b>&#25105;&#20204;&#21487;&#20197;&#20026; svnserve &#35774;&#32622;&#22797;&#21046;&#21527;&#65311;</b></p>
              
              <p>If you're using <span class="command"><strong>svnserve</strong></span> instead
              of Apache as your server, you can certainly configure
              your repository's hook scripts to invoke
              <span class="command"><strong>svnsync</strong></span> as we've shown here, thereby
              causing automatic replication from master to slaves.
              Unfortunately, at the time of this writing there is no way to
              make slave <span class="command"><strong>svnserve</strong></span> servers
              automatically proxy write requests back to the master
              server.  This means your users would only be able to
              check out read-only working copies from the slave
              servers.  You'd have to configure your slave servers to
              disallow write access completely.  This might be useful
              for creating read-only &#8220;<span class="quote">mirrors</span>&#8221; of popular
              open source projects, but it's not a transparent
              proxying system.</p>
            </div>
          </div>
        </div>
        
        <div class="section" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="svn.serverconfig.httpd.extra.other"></a>&#20854;&#23427;&#30340; Apache &#29305;&#24615;</h4></div></div></div>
          
          <p>Several of the features already provided by Apache in
          its role as a robust web server can be leveraged for
          increased functionality or security in Subversion as well.
          The Subversion client is able to use SSL (the Secure Sockets
          Layer, discussed earlier).  If your Subversion client is
          built to support SSL, it can access your Apache server
          using <code class="literal">https://</code> and enjoy a high-quality
          encrypted network session.</p>
          <p>&#21516;&#26679;&#26377;&#29992;&#30340;&#26159;Apache&#21644;Subversion&#20851;&#31995;&#30340;&#19968;&#20123;&#29305;&#24615;&#65292;&#20687;&#21487;&#20197;&#25351;&#23450;&#33258;&#23450;&#20041;&#30340;&#31471;&#21475;(&#32780;&#19981;&#26159;&#32570;&#30465;&#30340;HTTP&#30340;80)&#25110;&#32773;&#26159;&#19968;&#20010;Subversion&#21487;&#20197;&#34987;&#35775;&#38382;&#30340;&#34394;&#25311;&#20027;&#26426;&#21517;&#65292;&#25110;&#32773;&#26159;&#36890;&#36807;HTTP&#20195;&#29702;&#26381;&#21153;&#22120;&#35775;&#38382;&#30340;&#33021;&#21147;&#65292;&#36825;&#20123;&#29305;&#24615;&#37117;&#26159;Neon&#25152;&#25903;&#25345;&#30340;&#65292;&#25152;&#20197;Subversion&#36731;&#26131;&#24471;&#21040;&#36825;&#20123;&#25903;&#25345;&#12290;</p>
          <p>&#26368;&#21518;&#65292;&#22240;&#20026;<span class="command"><strong>mod_dav_svn</strong></span>&#26159;&#20351;&#29992;&#19968;&#20010;&#21322;&#23436;&#25104;&#30340;WebDAV/DeltaV&#26041;&#35328;&#65292;&#25152;&#20197;&#36890;&#36807;&#31532;&#19977;&#26041;&#30340;DAV&#23458;&#25143;&#31471;&#35775;&#38382;&#20063;&#26159;&#21487;&#33021;&#30340;&#65292;&#20960;&#20046;&#25152;&#26377;&#30340;&#29616;&#20195;&#25805;&#20316;&#31995;&#32479;(Win32&#12289;OS X&#21644;Linux)&#37117;&#26377;&#25226;DAV&#26381;&#21153;&#22120;&#24433;&#23556;&#20026;&#26222;&#36890;&#30340;&#32593;&#32476;&#8220;<span class="quote">&#20849;&#20139;</span>&#8221;&#30340;&#20869;&#32622;&#33021;&#21147;&#65292;&#36825;&#26159;&#19968;&#20010;&#22797;&#26434;&#30340;&#20027;&#39064;&#65307;&#23519;&#30475;<a class="xref" href="svn.webdav.html" title="&#38468;&#24405;&nbsp;C.&nbsp;WebDAV &#21644;&#33258;&#21160;&#29256;&#26412;">&#38468;&#24405;&nbsp;C, <i>WebDAV &#21644;&#33258;&#21160;&#29256;&#26412;</i></a>&#26469;&#24471;&#21040;&#26356;&#22810;&#32454;&#33410;&#12290;</p>
          <p>Note that there are a number of other small tweaks one can
          make to <span class="command"><strong>mod_dav_svn</strong></span> that are too obscure
          to mention in this chapter.  For a complete list of
          all <code class="filename">httpd.conf</code> directives
          that <span class="command"><strong>mod_dav_svn</strong></span> responds to, see
          <a class="xref" href="svn.ref.mod_dav_svn.conf.html#svn.ref.mod_dav_svn.conf.directives" title="&#25351;&#31034;">&#8220;&#25351;&#31034;&#8221;&#19968;&#33410;</a>.</p>
        </div>
      </div>
    <div class="footnotes"><br><hr width="100" align="left"><div class="footnote"><p><sup>[<a name="ftn.d4e5859" href="#d4e5859" class="para">42</a>] </sup>&#20182;&#20204;&#35752;&#21388;&#36825;&#26679;&#20570;&#12290;</p></div><div class="footnote"><p><sup>[<a name="ftn.d4e6013" href="#d4e6013" class="para">43</a>] </sup>&#24403;&#20351;&#29992;&#33258;&#31614;&#21517;&#30340;&#26381;&#21153;&#22120;&#26102;&#20173;&#20250;&#36973;&#21463;&#8220;<span class="quote">&#20013;&#38388;&#20154;</span>&#8221;&#25915;&#20987;&#65292;&#20294;&#26159;&#19982;&#20599;&#21462;&#26410;&#20445;&#25252;&#30340;&#23494;&#30721;&#30456;&#27604;&#65292;&#36825;&#26679;&#30340;&#25915;&#20987;&#27604;&#19968;&#20010;&#20598;&#28982;&#30340;&#33719;&#21462;&#35201;&#33392;&#38590;&#35768;&#22810;&#12290;</p></div><div class="footnote"><p><sup>[<a name="ftn.d4e6058" href="#d4e6058" class="para">44</a>] </sup>&#26356;&#22810;&#26377;&#23433;&#20840;&#24847;&#35782;&#30340;&#20154;&#19981;&#20250;&#24076;&#26395;&#22312;&#36816;&#34892;&#20013;<code class="filename">servers</code>&#25991;&#20214;&#20445;&#23384;&#23458;&#25143;&#31471;&#35777;&#20070;&#23494;&#30721;&#12290;</p></div><div class="footnote"><p><sup>[<a name="ftn.d4e6204" href="#d4e6204" class="para">45</a>] </sup>Back then, it was called ViewCVS.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="svn.serverconfig.svnserve.html">&#19978;&#19968;&#39029;</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="svn.serverconfig.html">&#19978;&#19968;&#32423;</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="svn.serverconfig.pathbasedauthz.html">&#19979;&#19968;&#39029;</a></td></tr><tr><td width="40%" align="left" valign="top">svnserve - &#23450;&#21046;&#30340;&#26381;&#21153;&#22120; &nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">&#36215;&#22987;&#39029;</a></td><td width="40%" align="right" valign="top">&nbsp;&#22522;&#20110;&#36335;&#24452;&#30340;&#25480;&#26435;</td></tr></table></div></body></html>