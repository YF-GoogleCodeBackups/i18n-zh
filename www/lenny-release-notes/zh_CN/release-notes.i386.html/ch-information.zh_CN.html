<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>第 5 章 lenny 中需要注意的问题</title><link rel="stylesheet" href="debian.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.73.2" /><link rel="start" href="index.zh_CN.html" title="Debian GNU/Linux 5.0 (&quot;lenny&quot;), Intel x86 的发行注记" /><link rel="up" href="index.zh_CN.html" title="Debian GNU/Linux 5.0 (&quot;lenny&quot;), Intel x86 的发行注记" /><link rel="prev" href="ch-upgrading.zh_CN.html" title="Chapter 4. Upgrades from previous releases" /><link rel="next" href="ch-moreinfo.zh_CN.html" title="第 6 章 关于 Debian GNU/Linux 的更多信息" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 5 章 lenny 中需要注意的问题</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch-upgrading.zh_CN.html">上一页</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch-moreinfo.zh_CN.html">下一页</a></td></tr></table><hr /></div><div class="chapter" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="ch-information"></a>第 5 章 lenny 中需要注意的问题</h2></div></div></div><div class="toc"><p><b>目录</b></p><dl><dt><span class="section"><a href="ch-information.zh_CN.html#problems">5.1. 潜在的问题</a></span></dt><dd><dl><dt><span class="section"><a href="ch-information.zh_CN.html#udev">5.1.1. 与 udev 相关的设备的问题</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#incompatible-2.4">5.1.2. 某些应用程序可能无法在 2.4 内核下工作</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#window-scaling">5.1.3. 某些网站无法通过 TCP 进行连接</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#poweroff">5.1.4. 无法自动关机</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#apt-pdiff">5.1.5. APT 软件包索引文件更新缓慢</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#hp-acpi">5.1.6. 在 lenny 内核中某些 HP 笔记本型号的 ACPI 支持被禁用</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#asynchronous-network-start">5.1.7. 异步网络初始化可能引起无法预测的情况</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#wpa">5.1.8. 使用 WPA 保护的无线网络的问题</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#partitionenc">5.1.9. 文件名中使用非 ASCII 字符可能引起问题</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#no-sound">5.1.10. 声音停止工作</a></span></dt></dl></dd><dt><span class="section"><a href="ch-information.zh_CN.html#upgrade-to-2.6">5.2. 升级到 2.6 内核</a></span></dt><dd><dl><dt><span class="section"><a href="ch-information.zh_CN.html#l2.6-keyboard">5.2.1. 键盘配置</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#l2.6-mouse">5.2.2. 鼠标配置</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#l2.6-sound">5.2.3. 声音配置</a></span></dt></dl></dd><dt><span class="section"><a href="ch-information.zh_CN.html#id2797898">5.3. <acronym title="网络文件系统">NFS</acronym> mounts now handled by nfs-common</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#xorg">5.4. XFree86 到 X.Org 的过渡</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#xorg-8bit">5.5. 很多应用程序没有 8 位显示支持</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#id2798190">5.6. 罗马尼亚(ro)键盘布局的改变</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#exim">5.7. 从 exim 升级到 exim4</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#apache2">5.8. 升级 apache2</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#zope">5.9. 升级 Zope 和 Plone</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#tar">5.10. Wildcard expansion (globbing) with <acronym title="GNU's Not Unix 的递归缩写">GNU</acronym> tar</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#nis">5.11. NIS 和网络管理器</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#php-globals">5.12. 废弃不安全的 php 配置</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#mozilla-security">5.13. Mozilla 产品的安全状态</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#kde-desktop-changes">5.14. KDE 桌面</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#gnome-desktop-changes">5.15. GNOME 桌面改变与支持</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#default-editor">5.16. 默认编辑器</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#motd">5.17. 每日信息</a></span></dt><dt><span class="section"><a href="ch-information.zh_CN.html#no-unicode">5.18. Emacs21 默认不支持 unicode</a></span></dt></dl></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="problems"></a>5.1. 潜在的问题</h2></div></div></div><p>
有时候，我们无法避免某些变化带来的副作用，或者我们在别的地方暴露了 Bug。我们在这里记录我们已知的问题。请您同时阅读勘误，相关软件包的文档，Bug 
报告以及在 <a class="xref" href="ch-moreinfo.zh_CN.html#morereading" title="6.1. 更多读物">第 6.1 节 “更多读物”</a> 中提到的其它信息。
</p><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="udev"></a>5.1.1. 与 udev 相关的设备的问题</h3></div></div></div><p>
虽然 <code class="systemitem">udev</code> 
经过了大量的测试，您仍可能在使用某些设备时遇到问题，这些需要修复。最常见的情况是需要修改设备的访问许可和所有权。有些情况下设备可能不会被默认创建(比如 
<code class="filename">/dev/video</code> and <code class="filename">/dev/radio</code>)。
</p><p>
<code class="systemitem">udev</code> 提供配置机制以处理这些问题。请见 <span class="citerefentry"><span class="refentrytitle">udev</span>(8)</span> 
和 <code class="filename">/etc/udev</code> 以获得更多信息。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="incompatible-2.4"></a>5.1.2. 某些应用程序可能无法在 2.4 内核下工作</h3></div></div></div><p>
某些 lenny 中的程序可能无法在 2.4 内核下工作，例如有些需要 <code class="literal">epoll()</code> 支持，而 
2.4 内核中没有。这些程序可能根本无法工作或者工作不正常，除非系统重启并使用 2.6 内核。
</p><p>
一个例子是 HTTP 代理 <code class="systemitem">squid</code> 。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="window-scaling"></a>5.1.3. 某些网站无法通过 TCP 进行连接</h3></div></div></div><p>
从 2.6.17 开始，Linux 大量使用 RFC 1323 中描述的 TCP 
窗口缩放。某些服务器会有不正常的行为，并向他们自己宣布错误的窗口大小。更多细节，请参考 bug 报告 <a class="ulink" href="http://bugs.debian.org/381262" target="_top">#381262</a>, <a class="ulink" href="http://bugs.debian.org/395066" target="_top">#395066</a>, <a class="ulink" href="http://bugs.debian.org/401435" target="_top">#401435</a> 。
</p><p>
通常有两个替代方法：或者将最大允许 TCP 窗口大小改回到一个较小的值(推荐)或者彻底关闭 TCP 窗口缩放(不推荐)。参见 <a class="ulink" href="http://www.debian.org/devel/debian-installer/errata" target="_top">debian-installer errata page</a> 中的示例命令。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="poweroff"></a>5.1.4. 无法自动关机</h3></div></div></div><p>
在一些旧系统中，<code class="literal">shutdown -h</code> 可能无法关闭机器(只是将其停止)。这是因为这里需要使用 apm。将 
<code class="literal">acpi=off apm=power_off</code> 添加到内核命令行，比如添加在 <code class="systemitem">grub</code> 或者 <code class="systemitem">lilo</code> 的配置文件中应该可以修正这个问题。请参见 bug <a class="ulink" href="http://bugs.debian.org/390547" target="_top">#390547</a> 以获取更多信息。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="apt-pdiff"></a>5.1.5. APT 软件包索引文件更新缓慢</h3></div></div></div><p>
默认情况下， lenny 版本的 <span class="command"><strong>apt</strong></span> 使用新的方法来更新 APT 软件包索引文件(当您运行 
<code class="literal">aptitude update</code> 时)，这将下载名叫 <code class="literal">pdiff</code> 
变化文件(而不是整个索引文件)。这个新特性应可以使用更少的带宽并且在大多数系统上运行更快。不幸的是，它可能同时会有反面效果，使得在有高速网络连接(或者离镜像服务器很近)而速度较慢的机器上如果更新不频繁会反而变慢，因为系统合并变化文件上花费的时间比下载完整软件包索引的时间更长。在配置文件 
<code class="filename">/etc/apt/apt.conf</code> 中加入 <code class="literal">Acquire::Pdiffs 
false;</code> 可以禁用此功能。
</p><p>
这个改变大部分情况下会影响 Debian <acronym title="GNU's Not Unix 的递归缩写">GNU</acronym>/Linux 的 <span class="emphasis"><em>unstable</em></span> 和 
<span class="emphasis"><em>testing</em></span> 分支的用户，因为他们的软件包更新很频繁。 lenny 
的用户主要会在他们的软件包接受安全更新时才会注意到这个特性。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="hp-acpi"></a>5.1.6. 在 lenny 内核中某些 HP 笔记本型号的 ACPI 支持被禁用</h3></div></div></div><p>
某些型号的 HP 笔记本电脑的 ACPI BIOS 与 lenny 中的 Linux 
			
			
			
			
			<span>2.6.26</span>
			
			
			
			
			
			 
内核不见容，这时会发生风扇不转进而导致不必要的高温。而且，风扇可能在系统挂起后无法正常工作。因此当检测到某些 ACPI BIOS 版本时内核会在内部禁用 
ACPI 支持。已知的受此问题影响的机器型号包括 HP nx6125, nx6120, nx6325, nc6120 和 nc6000 型号。
</p><p>
需要在这些系统上使用 ACPI 支持的用户可以安装 Linux 2.6.19 或者更新的内核。请参见 Debian bug <a class="ulink" href="http://bugs.debian.org/404143" target="_top">#404143</a> 和 <a class="ulink" href="http://bugs.debian.org/400488" target="_top">#400488</a>，以及 Linux Kernel's bugs <a class="ulink" href="http://bugzilla.kernel.org/show_bug.cgi?id=5534" target="_top">#5534</a> 和 <a class="ulink" href="http://bugzilla.kernel.org/show_bug.cgi?id=7122" target="_top">#7122</a> 以获取更多信息。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="asynchronous-network-start"></a>5.1.7. 异步网络初始化可能引起无法预测的情况</h3></div></div></div><p>
在使用 <code class="systemitem">udev</code> 为网络接口加载驱动的系统上，因为 
<code class="systemitem">udev</code> 的异步天性，使得系统启动时网络驱动可能无法在 
<span class="command"><strong>/etc/init.d/networking</strong></span> 执行前加载完成。虽然在 
<code class="filename">/etc/network/interfaces</code> 中加入 
<code class="literal">allow-hotplug</code> (与 <code class="literal">auto</code> 
一起使用)能保证在网络接口可用才将其启用，这仍然无法保证在启动进程开始启动网络服务前完成，而这些网络服务可能因没有网络接口而无法正常运行。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="wpa"></a>5.1.8. 使用 WPA 保护的无线网络的问题</h3></div></div></div><p>
在 etch 中，<code class="systemitem">wpasupplicant</code> 
软件包设置为系统服务，通过 <code class="filename">/etc/default/wpasupplicant</code> 和用户提供的 
<code class="filename">/etc/wpasupplicant.conf</code> 进行配置。
</p><p>
在 lenny 中，<code class="filename">/etc/init.d/wpasupplicant</code> 被抛弃，现在此 
Debian 软件包已经和 <code class="filename">/etc/network/interfaces</code>，类似其他软件包如 
<code class="systemitem">wireless-tools</code>。这意味着 <code class="systemitem">udev</code> 不再直接提供系统服务。
</p><p>
更多有关配置 wpasupplicant 的信息请参考 
<code class="filename">/usr/share/doc/wpasupplicant/README.modes.gz</code>，里面有 
<code class="filename">/etc/network/interfaces</code> 文件的例子。Debian 中有关使用 <code class="systemitem">wpasupplicant</code> 软件包的更新信息可以在 <a class="ulink" href="http://wiki.debian.org/WPA" target="_top">Debian Wiki</a> 中找到。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="partitionenc"></a>5.1.9. 文件名中使用非 ASCII 字符可能引起问题</h3></div></div></div><p>
挂载 vfat，ntfs 或者 iso9660 文件系统时，如果上面有文件的文件名包含非 ASCII 会在尝试使用这些文件名时引起失败，除非使用 
utf8 选项来挂载。可能会出现这样的失败错误：“无效或不完整的多字节字符或宽字符”。可行的解决方法是使用 
<code class="literal">defaults,utf8</code> 作为 vfat，ntfs 和 iso9660 
文件系统的挂载参数，如果他们上有文件名包含非 ASCII 字符。
</p><p>
请注意当使用 <code class="literal">utf8</code> 选项时 Linux 内核不支持处理 vfat 文件系统时忽略文件名的大小写。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="no-sound"></a>5.1.10. 声音停止工作</h3></div></div></div><p>
少数情况下更新后可能会没有声音。如果发生这种情况，请浏览 alsa 检查列表：以 root 身份运行 
<span class="command"><strong>alsaconf</strong></span>，将你的用户添加到 <code class="literal">audio</code> 组，使用 alsamixer 
并确保各个选项已开启并没有静音，确保 arts 或者 esound 已停止，确保 OSS 模块已卸载，确保扬声器已打开，检查 root 是否可以执行 
<code class="literal">cat /dev/urandom &gt; /dev/dsp</code> 命令。
</p></div></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="upgrade-to-2.6"></a>5.2. 升级到 2.6 内核</h2></div></div></div><p>
2.6 内核系列相比 2.4 系列包含大量的变化。很多模块被改名并且大量驱动被部分或者有些情况下完全重写。因此从较早的内核版本升级到 2.6 
内核并不是一个轻松的过程。本节旨在使您了解您可能会遇到的问题。
</p><p>
如果您从源代码编译您自己的内核，请确保您重启到这个 2.6 内核之前已经安装了 <code class="systemitem">module-init-tools</code>。这个软件包在 2.6 内核中代替了 <code class="systemitem">modutils</code>。如果您安装了 Debian <code class="systemitem">linux-image</code> 软件包中的一个，此软件包将会通过依赖关系自动被安装。
</p><p>
If you use <span class="emphasis"><em><acronym title="逻辑卷管理器">LVM</acronym></em></span>, you should also 
install <code class="systemitem">lvm2</code> before you reboot as 
the 2.6 kernel does not directly support LVM1.  To access LVM1 volumes, the 
compatibility layer of <code class="systemitem">lvm2</code> (the 
dm-mod module) is used.  You can leave <code class="systemitem">lvm10</code> installed; the init scripts will detect 
which kernel is used and execute the appropriate version.
</p><p>
如果您的 <code class="filename">/etc/modules</code> 
文件(系统启动时自动加载的模块列表)中有内容，请注意有些模块可能已经改名。如果发生这种情况您需要更新这个文件以使用新的模块名。
</p><p>
对于一些 SATA 磁盘控制器，指定给驱动器和它的分区的的设备文件可能会从 <code class="filename">/dev/hdX</code> 改名为 
<code class="filename">/dev/sdX</code>。如果发生这种情况，您需要修改您的 
<code class="filename">/etc/fstab</code> 
文件和启动加载器(bootloader)配置的相关部分。除非正确的修改这些设置，否则您的系统可能无法正确启动<sup>[<a id="id2797658" href="#ftn.id2797658" class="footnote">11</a>]</sup>。
</p><p>
一旦您安装好 2.6 内核，在重启之前，请确保您有恢复措施。首先，确保启动加载器(bootloader)配置同时包含新内核和旧的、可用的 2.4 
内核。您应该同时保证您手头有拯救软盘或者 CD-ROM，以防出现启动加载器(bootloader)配置错误导致您无法启动旧内核。
</p><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="l2.6-keyboard"></a>5.2.1. 键盘配置</h3></div></div></div><p>
2.6 内核中最激进的变化是输入层的彻底改变。此改变使得所有的键盘都和标准 PC 键盘一样。这意味着如果您目前选择了不同类型的键盘(比如 USB-MAC 
或者 Sun 键盘)，您将很可能在重启进入新的 2.6 内核后键盘无法工作。
</p><p>
如果您可以从其他系统 SSH 到您的机器，您可以通过执行 <code class="literal">dpkg-reconfigure 
console-data</code>，从完整列表中选择“挑选 keymap”选项并选择一种 pc 键盘类型来解决这个问题。
</p><p>
如果您的控制台键盘受此影响，您可能还需要为 X Window 系统重新配置您的键盘。为此您可以执行 <code class="literal">dpkg-reconfigure 
xserver-xorg</code> 或者直接编辑 <code class="filename">/etc/X11/xorg.conf</code>。不要忘记阅读 
<a class="xref" href="ch-upgrading.zh_CN.html#nownownow" title="4.7. Things to do before rebooting">Section 4.7, “Things to do before rebooting”</a> 中提到的文档。
</p><p>
This issue is unlikely to affect the 
		     
		     
		     
		     
		     <span>Intel x86</span>
		     
		     
		     
		     
		     
		      architecture as all PS/2 
and most <acronym title="通用串行总线">USB</acronym> keyboards will already be configured as a 
normal PC keyboard.
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="l2.6-mouse"></a>5.2.2. 鼠标配置</h3></div></div></div><p>
还是因为输入层的改变，如果更新到 2.6 内核后您的鼠标不工作，您可能需要重新配置 X Window 系统和 <code class="systemitem">gpm</code>。最可能出现的情况是获取鼠标数据的设备更改了。您可能还需要加载不同的模块。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="l2.6-sound"></a>5.2.3. 声音配置</h3></div></div></div><p>
For the 2.6 kernel series the <acronym title="高级Linux声音架构">ALSA</acronym> sound drivers are 
recommended over the older OSS sound drivers.  <acronym title="高级Linux声音架构">ALSA</acronym> sound 
drivers are provided as modules by default.  In order for sound to work, the 
<acronym title="高级Linux声音架构">ALSA</acronym> modules appropriate for your sound hardware need to 
be loaded.  In general this will happen automatically if you have, in 
addition to the <code class="systemitem">alsa-base</code> package, 
either the <code class="systemitem">hotplug</code> package or the 
<code class="systemitem">discover</code> package installed.  The 
<code class="systemitem">alsa-base</code> package also blacklists 
OSS modules to prevent <span class="command"><strong>hotplug</strong></span> and 
<span class="command"><strong>discover</strong></span> from loading them.  If you have OSS modules 
listed in <code class="filename">/etc/modules</code>, you should remove them.
</p></div></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2797898"></a>5.3. <acronym title="网络文件系统">NFS</acronym> mounts now handled by nfs-common</h2></div></div></div><p>
    Since <code class="systemitem">util-linux</code> 2.13 
<acronym title="网络文件系统">NFS</acronym> mounts are no longer handled by <code class="systemitem">util-linux</code> itself, but by <code class="systemitem">nfs-common</code>. Since not all systems mount 
<acronym title="网络文件系统">NFS</acronym> shares and to avoid a standard portmapper 
installation <code class="systemitem">util-linux</code> only 
suggests <code class="systemitem">nfs-common</code>. If you need to 
mount <acronym title="网络文件系统">NFS</acronym> shares, make sure <code class="systemitem">nfs-common</code> is installed on your system. The 
preinstallation script of the <code class="systemitem">mount</code> 
package checks, whether <acronym title="网络文件系统">NFS</acronym> mounts exist and aborts if 
<code class="filename">/usr/sbin/mount.nfs</code> from <code class="systemitem">nfs-common</code> is not present.
  </p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="xorg"></a>5.4. XFree86 到 X.Org 的过渡</h2></div></div></div><p>
到 X.Org 的迁移涉及一些结构上的变化。如果所有已经安装的软件包都来自 Debian 并且也包含在 lenny 
发行中，升级过程应该不会出现问题。但是，经验显示您仍需了解一些变化，因为它们可能在升级过程中产生潜在的问题。
</p><p>
最重要的变化是 <code class="filename">/usr/X11R6/bin</code> 已经被抛弃并且仅保留为到 
<code class="filename">/usr/bin</code> 的符号链接。这意味着新软件包安装过后此目录应该为空。新的软件包设置为与大部分使用 
<code class="filename">/usr/X11R6/bin</code> 的软件包冲突，但有些情况下仍然需要人为干预。请切记不要在 X 
会话中执行系统升级。
</p><p>
如遇到在 X.Org 安装时升级中止的情况，您应该检查 <code class="filename">/usr/X11R6/bin</code> 
中是否有遗留文件。您可以通过 <code class="literal">dpkg -S</code> 命令找出这些文件(如果存在)属于哪些 Debian 软件包，并使用 
<code class="literal">dpkg --remove</code> 
命令移除这些软件包。请记录下您所移除的软件包，以便稍后安装替代的软件包。继续更新之前，需要移除所有 
<code class="filename">/usr/X11R6/bin</code> 中的文件。
</p><p>
请阅读 <a class="ulink" href="http://wiki.debian.org/Xorg69To7" target="_top">http://wiki.debian.org/Xorg69To7</a> 以获取更多信息和其他问题。
</p><p>
如果您重启后使用 X.Org 遇到问题，您可能需要通过执行 <code class="literal">/etc/init.d/xfs restart</code> 
来重启字体服务。发生这种情况是因为 <code class="filename">/etc/X11/fs/xfs.options</code> 包含一行 
<code class="literal">no-restart-on-upgrade</code>，但字体路径改变了。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="xorg-8bit"></a>5.5. 很多应用程序没有 8 位显示支持</h2></div></div></div><p>
更新到 X.Org 和最新的库之后，只能显式 8 位色深的 X 终端将无法工作。这是因为 Cairo 2D 矢量图形库(<code class="systemitem">libcairo2</code>)没有 8 位伪色支持。此库应用于 GNOME 和 Xfce 
桌面以及许多编译使用 Gtk2+ 库的桌面应用程序，比如 <code class="systemitem">abiword</code>。
</p><p>
已知受影响的系统包括 Sun 机器和 Tektronix，NCD，IBM 和 SGI 的 X 终端，以及一些其他的 X 
窗体系统。如果可能，您需要配置这些终端使用 16 位颜色。
</p><p>
更多信息在 Freedesktop 的 <a class="ulink" href="https://bugs.freedesktop.org/show_bug.cgi?id=4945" target="_top">bug #4945</a>。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id2798190"></a>5.6. 罗马尼亚(ro)键盘布局的改变</h2></div></div></div><p>
    由于在 lenny 中升级到 <code class="systemitem">xkb-data</code> 版本 
1.3 默认的罗马尼亚(ro)布局变体现在可以产生正确的 șț 字符(注意下面的逗号)而不是 şţ 
(注意下面的下加符)。还有一些变体已经改名。旧的变体名字仍然可以工作，不过建议用户更新他们的 
<code class="filename">/etc/X11/xorg.conf</code>。因这个改变更多信息以及可能导致的副作用在 <a class="ulink" href="http://wiki.debian.org/L10N/Romanian/Lenny/Notes" target="_top"> wiki 
(仅罗马尼亚语)</a>。
  </p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="exim"></a>5.7. 从 exim 升级到 exim4</h2></div></div></div><p>
One of the packages that has been obsoleted by the lenny release is 
the Mail Transfer Agent (<acronym title="邮件传输代理">MTA</acronym>) <code class="systemitem">exim</code>, which has been replaced by the completely 
new package <code class="systemitem">exim4</code>.
</p><p>
<span class="command"><strong>exim</strong></span> (版本 3.xx)的上游几年前已经停止维护，现在 Debian 也放弃了对该版本的支持。如果您仍然在使用 
<span class="command"><strong>exim</strong></span> 3.xx，请手动升级您的 <code class="systemitem">exim</code> 安装到 <code class="systemitem">exim4</code>。因为 <code class="systemitem">exim4</code> 已经是 etch 的组件，您可以选择升级到 
lenny 之前先在您的 etch 系统上进行升级，或者在 lenny 
升级之后，看您的方便。请记住您的旧 <code class="systemitem">exim</code> 软件包不会被升级也不会在 
etch 支持结束后获得安全更新。
</p><p>
请注意，根据您的 <code class="systemitem">debconf</code> 的配置不同，您在安装 
<code class="systemitem">exim4</code> 
的时候可能不会被问及任何配置问题。如果没有问您问题，系统会默认到“本地投递”设置。可以通过 <code class="literal">dpkg-reconfigure 
exim4-config</code> 命令来配置。
</p><p>
Debian 中的 <code class="systemitem">exim4</code> 软件包有详细的文档。此软件包的主页在 
Debian wiki 上的 <a class="ulink" href="http://wiki.debian.org/PkgExim4" target="_top">http://wiki.debian.org/PkgExim4</a>，README 文件可以在 <a class="ulink" href="http://pkg-exim4.alioth.debian.org/README/README.Debian.html" target="_top">http://pkg-exim4.alioth.debian.org/README/README.Debian.html</a> 
或者软件包中找到。
</p><p>
README 文件包含有关打包的章节，其中解释了我们提供的软件包变体的不同，以及有关从 <span class="command"><strong>Exim</strong></span> 3 
升级的章节，这将帮助您进行实际的迁移。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="apache2"></a>5.8. 升级 apache2</h2></div></div></div><p>
    Apache2 默认配置在一些方面有所改变，这需要手工改变您的配置。最重要的改变有：
  </p><p>
    <code class="literal">NameVirtualHost *</code> 被改为 <code class="literal">NameVirtualHost 
*:80</code>。如果您加入了更多基于名称的虚拟主机，您需要依次将 <code class="literal">&lt;VirtualHost 
*&gt;</code> 修改为 <code class="literal">&lt;VirtualHost *:80&gt;</code>。
  </p><p>
    Apache User 和 Group 以及 PidFile 路径现在在 
<code class="filename">/etc/apache2/envvars</code> 
中进行配置。如果您从这些设置的默认值进行了修改，您需要修改那个文件。这也意味着您无法通过 <span class="command"><strong>apache2 -k 
start</strong></span> 启动 apache2，您需要使用 <span class="command"><strong>/etc/init.d/apache2</strong></span> 或者 
<span class="command"><strong>apache2ctl</strong></span>。
  </p><p>
    Mod_suexec 所需要的 suexec 帮助程序现在通过单独的软件包 <code class="systemitem">apache2-suexec</code> 来发行，此软件包不会默认安装。
  </p><p>
    更多模块相关的配置从 <code class="filename">/etc/apache2/apache2.conf</code> 移到了 
<code class="filename">/etc/apache2/mods-available/*.conf</code>。
  </p><p>
    要获取更多详细信息，请参见 
<code class="filename">/usr/share/doc/apache2.2-common/NEWS.Debian.gz</code> 和 
<code class="filename">/usr/share/doc/apache2.2-common/README.Debian.gz</code>。
  </p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="zope"></a>5.9. 升级 Zope 和 Plone</h2></div></div></div><p>
Zope 和所有相关的产品都更新了。也有许多产品从发行中抛弃(或者因为他们已经过时，或者他们与新的 Zope, CMF 或者 Plone 不兼容)。
</p><p>
不幸的是没有简单可靠的方法来升级 <span class="command"><strong>zope</strong></span> 或者 <span class="command"><strong>plone</strong></span> 服务器。即使 
Plone 包括一个迁移工具，经验显示自动迁移很容易失败。
</p><p>
因为这个原因，推荐用户设置他们的系统以使他们可以继续平行运行 etch 安装中的 Zope/Plone 和新的 
lenny 中的版本并测试迁移情况。
</p><p>
达到这个目的最简单且最安全的方法，就是拷贝您的 etch 系统到另一个硬盘或分区，然后只升级两个副本中的一个。您之后可以使用 
<span class="command"><strong>chroot</strong></span> 来平行运行 etch 版本和 lenny 版本。
</p><p>
无法在 lenny 系统同时安装 Zope/Plone 的旧版本和新版本，一部分原因是由于旧的软件包依赖 <code class="systemitem">python2.3</code> 而它无法与 <code class="systemitem">python2.4</code> 同时安装。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="tar"></a>5.10. Wildcard expansion (globbing) with <acronym title="GNU's Not Unix 的递归缩写">GNU</acronym> tar</h2></div></div></div><p>
Previous versions of <acronym title="GNU's Not Unix 的递归缩写">GNU</acronym> <span class="command"><strong>tar</strong></span> assumed 
shell-style globbing when extracting files from or listing an archive.  For 
example:
</p><pre class="screen">
tar xf foo.tar '*.c'
</pre><p>
would extract all files whose names end in '.c'.  This behavior was not 
documented and was incompatible with traditional <span class="command"><strong>tar</strong></span> 
implementations.  Therefore, starting from version 1.15.91, 
<acronym title="GNU's Not Unix 的递归缩写">GNU</acronym> <span class="command"><strong>tar</strong></span> no longer uses globbing by 
default.  For example, the above invocation is now interpreted as a request 
to extract from the archive the file named '*.c'.
</p><p>
参见 <code class="filename">/usr/share/doc/tar/NEWS.gz</code> 以获取更多信息。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="nis"></a>5.11. NIS 和网络管理器</h2></div></div></div><p>
lenny 中的 <code class="systemitem">nis</code> 所包含的 
<span class="command"><strong>ypbind</strong></span> 版本包含网络控制器支持。当网络管理器报告电脑从网络断开时，此支持会导致 
<span class="command"><strong>ypbind</strong></span> 禁用 NIS 客户端功能。因为网络管理器通常会在不使用网络时发出此报告，NIS 客户端系统的 NIS 
用户应确保禁用这些系统上的网络管理器支持。
</p><p>
要做到这一点可以通过卸载 <code class="systemitem">network-manager</code> 
软件包，或者编辑 <code class="filename">/etc/default/nis</code> 并添加 
<code class="literal">-no-dbus</code> 到 <code class="literal">YPBINDARGS</code>。
</p><p>
新安装的 Debian 会默认使用 <code class="literal">-no-dbus</code>，而之前的发行版本不是默认的。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="php-globals"></a>5.12. 废弃不安全的 php 配置</h2></div></div></div><p>
多年来，已知在 PHP 中开启 <code class="literal">register_globals</code> 
设置是不安全并且危险的，而这个设置已经默关闭有一段时间了。这个配置现在在 Debian 系统终于因为过于危险而废除。这同样应用于 
<code class="literal">safe_mode</code> 和 <code class="literal">open_basedir</code> 
的缺陷，这些也有一段时间没有维护了。
</p><p>
从这一发行版本开始，Debian 安全团队不再为一些已知不安全的 PHP 配置提供提供安全支持了。最重要的，因开启 
<code class="literal">register_globals</code> 而导致的问题将不会被处理。
</p><p>
如果您运行很旧的需要 <code class="literal">register_globals</code> 的应用程序，请只为相关的路径开启，例如通过 Apache 
配置文件。更多的信息在 PHP 文档目录 (<code class="filename">/usr/share/doc/php4</code>, 
<code class="filename">/usr/share/doc/php5</code>) 中的 
<code class="filename">README.Debian.security</code> 文件
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="mozilla-security"></a>5.13. Mozilla 产品的安全状态</h2></div></div></div><p>
Mozilla 程序 <code class="systemitem">firefox</code> 和 <code class="systemitem">thunderbird</code> (在 Debian 中分别更名为 <code class="systemitem">iceweasel</code> 和 <code class="systemitem">icedove</code>)，对许多用户来说是重要的工具。不幸的是上游的安全策略是主张用户更新到新版本，而这与 
Debian “不在安全更新中发行大的功能改变”的策略相冲突。我们今天无法预测，但在 lenny 的生命周期中 Debian 
安全团队可能会遇到无法继续支持 Mozilla 产品并宣布对 Mozilla 产品的安全支持的终止。在部署 Mozilla 
时，如果缺乏安全更新对您来说是一个问题，您需要考虑到这一点并可以考虑 Debian 中的替代品。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="kde-desktop-changes"></a>5.14. KDE 桌面</h2></div></div></div><p>
在 lenny 中的 KDE 媒体支持从使用 <code class="filename">device:/</code> 更改为使用 
<code class="filename">media:/</code>。一些用户配置文件可能存储了 <code class="filename">device:/</code> 
链接，而这些需要修改。特别是 
<code class="filename">~/.kde/share/apps/konqsidebartng/virtual_folders/services</code> 
包含这个引用并且可以被安全删除因为新建用户不会创建这个文件。
</p><p>
etch 中的发行的 KDE 桌面环境版本相比 lenny 中的版本有很多的改变，您可以在 <a class="ulink" href="http://www.kde.org/announcements/announce-3.5.php" target="_top">KDE 3.5 Release 
Notes</a> 中找到更多的信息。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="gnome-desktop-changes"></a>5.15. GNOME 桌面改变与支持</h2></div></div></div><p>
如果您在 etch 使用 GNOME 桌面您将无法从 lenny 发行中 Debian 
默认配置中引入的改变中受益。在某些极端情况下 GNOME 桌面可能无法正常处理您的旧配置并且可能会无法正常运行。
</p><p>
如果您没有花费太多经历在配置您的 GNOME 桌面上您可以移动用户家(home)目录中的 <code class="filename">.gconf</code> 
目录到不同的名字(比如 <code class="filename">.gconf.old</code>)这样在新的会话启动时会为 lenny 
重新创建默认配置。
</p><p>
从 lenny 发行起，Debian 不再包含大部分过时的 GNOME 版本 1 
中的软件包，虽然有些软件包仍然保留下来以便支持某些没有更新到 GNOME 2 的 Debian 软件包。GTK1.2 的软件包仍然得到完全的维护。
</p><p>
lenny 版本中的GNOME 桌面环境相比 etch 中发行的版本有大量的变化，您可以在 <a class="ulink" href="http://www.gnome.org/start/2.14/notes/en/" target="_top">GNOME 2.14 Release 
Notes</a> 找到更多信息。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="default-editor"></a>5.16. 默认编辑器</h2></div></div></div><p>
如果您之前使用 <span class="command"><strong>vim</strong></span> 作为您的默认编辑器，升级时可能会改为 <span class="command"><strong>nano</strong></span>。
</p><p>
希望为所有用户更改默认编辑器的管理员需要更新替代系统，使用：
</p><pre class="screen">
# update-alternatives --config editor
</pre><p>
希望改变默认编辑器的用户可以通过在他们的配置文件中加入以下几行来定义环境变量 <span class="emphasis"><em>EDITOR</em></span>：
</p><pre class="screen">
EDITOR=vi
export EDITOR
alias editor=$EDITOR
</pre></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="motd"></a>5.17. 每日信息</h2></div></div></div><p>
<code class="filename">/etc/motd</code> 现在是到 <code class="filename">/var/run/motd</code> 
的符号链接，而后者会由 <span class="command"><strong>/etc/init.d/bootmisc.sh</strong></span> 在每次重启时从模板 
<span class="command"><strong>/etc/motd.tail</strong></span> 重新编译。这意味着对 <code class="filename">/etc/motd</code> 
的修改将会丢失。对 <code class="filename">/etc/motd.tail</code> 的修改不会自动应用于 
<code class="filename">/etc/motd</code> 除非重启系统。
</p><p>
而且，<code class="filename">/etc/default/rcS</code> 中的 EDITMOTD 变量不再有任何效果。如果您希望禁用更新 
motd，或者希望为每日信息维护您自己的内容您只需要将 <code class="filename">/etc/motd</code> 符号链接到不同的文件比如 
<code class="filename">/etc/motd.static</code> 并在那里进行您的修改。
</p></div><div class="section" lang="zh-CN" xml:lang="zh-CN"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="no-unicode"></a>5.18. Emacs21 默认不支持 unicode</h2></div></div></div><p>
Emacs21 和 emacs21-nox 默认不配置为支持 Unicode。更多信息和替代方案请参见 <a class="ulink" href="http://bugs.debian.org/419490" target="_top">Bug #419490</a>。
</p></div><div class="footnotes"><br /><hr width="100" align="left" /><div class="footnote"><p><sup>[<a id="ftn.id2797658" href="#id2797658" class="para">11</a>] </sup> 内核可以启动但是尝试挂载 root 文件系统时会失败并输出错误信息 <span class="emphasis"><em>waiting for root file 
system</em></span> 以及 <span class="emphasis"><em>unable to mount /dev/hdX ..not 
found</em></span> 后中止。在您通过内核启动信息或者通过检查 <code class="filename">/dev/disk/</code> 
的内容确定新分配的设备名后，您可以使用 <span class="command"><strong>initramfs</strong></span> shell 来修改这个问题。  </p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch-upgrading.zh_CN.html">上一页</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch-moreinfo.zh_CN.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 4. Upgrades from previous releases </td><td width="20%" align="center"><a accesskey="h" href="index.zh_CN.html">起始页</a></td><td width="40%" align="right" valign="top"> 第 6 章 关于 Debian <acronym title="GNU's Not Unix 的递归缩写">GNU</acronym>/Linux 的更多信息</td></tr></table></div></body></html>
